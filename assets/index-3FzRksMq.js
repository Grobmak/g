import{j as we,r as f,k as e,b as ns,R as K,l as is}from"./vendor-react-core-BVIZezs9.js";import{t as os,p as Ae,a as Pe,b as cs,d as ds}from"./vendor-utils-69Z7c79o.js";import{H as Ie,M as xs,L as ms,S as hs,P as te,a as ae,b as $e,E as Le,c as ps,C as Oe,d as Ee,e as fe,T as Re,X as ne,f as De,g as qe,h as ze,i as Be,I as us,j as ie,k as se,l as bs,m as je,n as gs,R as Ue,o as Ve,B as le,p as ve,q as oe,A as ce,r as Ce,s as fs,t as js,u as He,v as We,w as R,D as Q,x as vs,y as Xe,z as de,F as xe,G as Ge,J as re,K as Se,N as Ns,O as ye,Q as ws,U as ys,V as _s,W as ks,Y as Cs,Z as Ss,_ as me,$ as Ms,a0 as Ke,a1 as Fs,a2 as Ts,a3 as As,a4 as Ps,a5 as Qe,a6 as Is,a7 as $s,a8 as Ls,a9 as Os,aa as Me,ab as Es,ac as Rs,ad as Ds,ae as qs,af as zs,ag as Bs,ah as Us,ai as Vs,aj as Hs,ak as Ws}from"./vendor-icons-Noa87TUF.js";import{l as Ye,f as Je,K as W,y as Ze,g as z,h as he,O as B,z as pe,Q as _e,H as Xs,k as Gs,B as Ks,U as Qs,a as Ys}from"./vendor-ui-lib-DeyF9ZjD.js";import{l as es}from"./vendor-print-7iyCkULn.js";import{f as Js}from"./vendor-date-CSQe5d3I.js";import"./vendor-misc-D4NfaneA.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}})();const Zs="marnthara.input.v6.4",Fe=1.19599,Te=[{label:"ม่านลอน (Wave)",value:"ลอน"},{label:"ม่านจีบ (Pleated)",value:"จีบ"},{label:"ม่านตาไก่ (Eyelet)",value:"ตาไก่"},{label:"ม่านพับ (Roman)",value:"พับ"},{label:"ม่านแป๊บ/สอดราง (Rod)",value:"แป๊บ"},{label:"ม่านหลุยส์ (Louis)",value:"หลุยส์"}],U={curtain:{id:"curtain",name:"ผ้าม่าน",unit:"ชุด",color:"bg-indigo-500",icon:"AlignLeft"},wallpaper:{id:"wallpaper",name:"วอลเปเปอร์",unit:"ตร.ม.",color:"bg-orange-500",icon:"ScrollText"},roller_blind:{id:"roller_blind",name:"ม่านม้วน",unit:"ชุด",color:"bg-blue-500",icon:"Minimize2"},wooden_blind:{id:"wooden_blind",name:"มู่ลี่ไม้/โฟม",unit:"ชุด",color:"bg-amber-600",icon:"Blinds"},vertical_blind:{id:"vertical_blind",name:"ม่านปรับแสง",unit:"ชุด",color:"bg-cyan-500",icon:"Columns"},aluminum_blind:{id:"aluminum_blind",name:"มู่ลี่อลูมิเนียม",unit:"ชุด",color:"bg-slate-500",icon:"Blinds"},partition:{id:"partition",name:"ฉากกั้นห้อง",unit:"ชุด",color:"bg-emerald-600",icon:"Grid3X3"},pleated_screen:{id:"pleated_screen",name:"มุ้งจีบ",unit:"ชุด",color:"bg-pink-500",icon:"Grid3X3"},removal:{id:"removal",name:"รื้อถอน/ค่าแรง",unit:"งาน",color:"bg-red-500",icon:"Scissors"}},et={style_surcharge:{ลอน:0,จีบ:0,ตาไก่:0,พับ:0,หลุยส์:500}},st={ROLL_WIDTH_M:.53},tt={name:"Marnthara Smart Quotation",address:"",phone:"",taxId:"",logoUrl:"",baseVatRate:0,bankAccount:{bankName:"",accountName:"",accountNumber:"",branch:"",isEnabled:!0},pdf:{paymentTerms:"มัดจำ 50% ก่อนเริ่มงาน ส่วนที่เหลือชำระหลังติดตั้งเสร็จสิ้น",priceValidity:"7 วัน",notes:["ราคาดังกล่าวรวมค่าติดตั้งและขนส่งแล้ว","รับประกันการติดตั้ง 1 ปี"]}},at=s=>({customer:{name:"",phone:"",address:"",taxId:"",installationAddress:"",useSameAddress:!0,showInstallationAddress:!0},setCustomer:t=>s(a=>({customer:{...a.customer,...t}}))}),ee=()=>Math.random().toString(36).substring(2,9),lt=s=>({rooms:[],addRoom:t=>s(a=>({rooms:[...a.rooms,{id:ee(),name:t||`ห้องที่ ${a.rooms.length+1}`,items:[],is_suspended:!1,room_defaults:{}}]})),updateRoom:(t,a)=>s(r=>({rooms:r.rooms.map(l=>l.id===t?{...l,...a}:l)})),removeRoom:t=>s(a=>({rooms:a.rooms.filter(r=>r.id!==t)})),duplicateRoom:t=>s(a=>{const r=a.rooms.find(o=>o.id===t);if(!r)return a;const l={...r,id:ee(),name:`${r.name} (Copy)`,items:r.items.map(o=>({...o,id:ee()}))};return{rooms:[...a.rooms,l]}}),toggleRoomSuspension:t=>s(a=>({rooms:a.rooms.map(r=>r.id===t?{...r,is_suspended:!r.is_suspended}:r)})),updateRoomDefaults:(t,a)=>s(r=>({rooms:r.rooms.map(l=>l.id===t?{...l,room_defaults:{...l.room_defaults,...a}}:l)})),addItem:(t,a)=>s(r=>({rooms:r.rooms.map(l=>l.id===t?{...l,items:[...l.items,{...a,id:ee()}]}:l)})),updateItem:(t,a,r)=>s(l=>({rooms:l.rooms.map(o=>o.id!==t?o:{...o,items:o.items.map(m=>m.id===a?{...m,...r}:m)})})),removeItem:(t,a)=>s(r=>({rooms:r.rooms.map(l=>l.id!==t?l:{...l,items:l.items.filter(o=>o.id!==a)})})),duplicateItem:(t,a)=>s(r=>({rooms:r.rooms.map(l=>{if(l.id!==t)return l;const o=l.items.find(m=>m.id===a);return o?{...l,items:[...l.items,{...o,id:ee()}]}:l})})),resetAll:()=>s({rooms:[],customer:{name:"",phone:"",address:""},discount:{type:"amount",value:0}}),loadState:t=>{s(a=>({...a,...t}))}}),rt=s=>({shopConfig:tt,discount:{type:"amount",value:0},setDiscount:t=>s({discount:t}),updateShopConfig:t=>s(a=>({shopConfig:{...a.shopConfig,...t}}))}),nt=()=>Math.random().toString(36).substring(2,9),it=s=>({favorites:{},addFavorite:(t,a)=>s(r=>{const l=r.favorites[t]||[],o=l.find(m=>m.code===a.code);return o?{favorites:{...r.favorites,[t]:l.map(m=>m.id===o.id?{...m,...a}:m)}}:{favorites:{...r.favorites,[t]:[...l,{...a,id:nt()}]}}}),removeFavorite:(t,a)=>s(r=>({favorites:{...r.favorites,[t]:(r.favorites[t]||[]).filter(l=>l.id!==a)}}))}),ot=s=>({activeModal:null,modalProps:{},openModal:(t,a={})=>s({activeModal:t,modalProps:a}),closeModal:()=>s({activeModal:null,modalProps:{}})}),k=we()(os(Ae((...s)=>({...at(...s),...lt(...s),...rt(...s),...it(...s),...ot(...s)}),{name:Zs,storage:Pe(()=>localStorage),version:1,partialize:s=>{const{activeModal:t,modalProps:a,...r}=s;return r}}),{limit:20,partialize:s=>{const{activeModal:t,modalProps:a,...r}=s;return r}})),N=s=>{if(typeof s=="number")return Number.isFinite(s)?s:0;if(!s)return 0;const t=typeof s=="string"?s.replace(/,/g,""):String(s),a=parseFloat(t);return Number.isFinite(a)?a:0},I=s=>{const t=N(s);return t>0?t.toFixed(2):""},ss=s=>{const t=s.replace(/,/g,"").trim();if(t===""||t===".")return"";let a=parseFloat(t);return isNaN(a)?s:(Math.abs(a)>=10&&(a=a/100),a.toFixed(2))},Ne=(s,t=2,a=!1)=>Number.isFinite(s)?s.toLocaleString("th-TH",{minimumFractionDigits:a?2:0,maximumFractionDigits:t}):"0",F=s=>Ne(s,2,!0),ct=s=>{if(!s)return"ศูนย์บาทถ้วน";const t=["ศูนย์","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า","สิบ"],a=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];s=parseFloat(s.toFixed(2));let r="";if(s===0)return"ศูนย์บาทถ้วน";const l=c=>{let x="";const d=String(c);for(let p=0;p<d.length;p++){const u=parseInt(d[p]),h=d.length-p-1;u!==0&&(h===1&&u===1?x+=a[h]:h===1&&u===2?x+="ยี่"+a[h]:h===0&&u===1&&d.length>1?x+="เอ็ด":x+=t[u]+a[h])}return x},o=Math.floor(s),m=Math.round((s-o)*100);return o>0&&(r+=l(o),r+="บาท"),m>0?(r+=l(m),r+="สตางค์"):r+="ถ้วน",r},T={getStyleSurcharge:s=>et.style_surcharge[s]||0,fabricYardage:(s,t)=>{const a=N(t);if(a<=0)return 0;let r=a*2.5;return s==="พับ"&&(r=a*1.5),r*1.1},calculateCurtainPrice:s=>{const t=N(s.width_m);if(t<=0)return{total:0,fabricPrice:0,sheerPrice:0,louisPrice:0,fabricMeters:0,sheerMeters:0,railPrice:0,accessoryPrice:0};let a=0;s.price_per_m_raw&&N(s.price_per_m_raw)>0?a=t*N(s.price_per_m_raw):a=T.fabricYardage(s.style,t)*N(s.price_sqyd);let r=0;s.layer_mode!=="main"&&(s.sheer_price_per_m&&N(s.sheer_price_per_m)>0?r=t*N(s.sheer_price_per_m):s.sheer_price_sqyd&&(r=T.fabricYardage(s.style,t)*N(s.sheer_price_sqyd)));let l=0;if(s.use_rail&&s.rail_price_per_m){const c=s.layer_mode==="double"?2:1;l=t*N(s.rail_price_per_m)*c}const o=T.getStyleSurcharge(s.style);let m=a+r+l+o;return s.enable_set_price&&N(s.set_price_override)>0&&(m=N(s.set_price_override)),{total:Math.round(m*100)/100,fabricPrice:a,sheerPrice:r,louisPrice:0,fabricMeters:t,sheerMeters:s.layer_mode!=="main"?t:0,railPrice:l,accessoryPrice:o}},calculateWallpaperPrice:s=>{const t=s.widths.reduce((u,h)=>u+N(h),0),a=N(s.height_m);if(t<=0||a<=0)return{total:0,rolls:0,rollPrice:0,installPrice:0,rollCost:0};const l=Math.ceil(t/st.ROLL_WIDTH_M),o=N(s.price_per_roll),m=N(s.install_cost_per_roll),c=l*o,x=l*m,d=c;let p=c+x;return s.enable_set_price&&N(s.set_price_override)>0&&(p=N(s.set_price_override)),{total:Math.round(p*100)/100,rolls:l,rollPrice:c,installPrice:x,rollCost:d}},calculateAreaBasedPrice:s=>{const t=N(s.width_m),a=N(s.height_m),r=N(s.price_sqyd);if(t<=0||a<=0)return{total:0,sqm:0,sqyd:0};if(s.enable_set_price&&N(s.set_price_override)>0)return{total:N(s.set_price_override),sqm:t*a,sqyd:t*a*Fe};const l=t*a,o=l*Fe,c=Math.max(o,1.2)*r;return{total:Math.round(c*100)/100,sqm:l,sqyd:o}},calculateAreaPrice:s=>T.calculateAreaBasedPrice(s),calculateRemovalPrice:s=>{if(!s||s.is_suspended)return{total:0};if(s.enable_set_price&&N(s.set_price_override)>0)return{total:N(s.set_price_override)};const t=N(s.quantity),a=N(s.price_per_item);if(t<=0||a<=0)return{total:0};const r=t*a;return{total:Math.round(r*100)/100}},getItemPrice:s=>{if(s.is_suspended)return 0;switch(s.type){case"curtain":return T.calculateCurtainPrice(s).total;case"wallpaper":return T.calculateWallpaperPrice(s).total;case"wooden_blind":case"roller_blind":case"vertical_blind":case"aluminum_blind":case"partition":case"pleated_screen":return T.calculateAreaBasedPrice(s).total;case"removal":return T.calculateRemovalPrice(s).total;default:return 0}}},ue=()=>{const s=k(l=>l.rooms),t=k(l=>l.discount),a=k(l=>l.shopConfig);return f.useMemo(()=>{const l=s.map(u=>{if(u.is_suspended)return{roomId:u.id,total:0,itemCount:u.items.length,isSuspended:!0};const g=u.items.map(j=>T.getItemPrice(j)).reduce((j,_)=>j+_,0);return{roomId:u.id,total:g,itemCount:u.items.length,isSuspended:!1}}),o=l.reduce((u,h)=>u+h.total,0);let m=o,c=0;t.is_enabled===!0&&t.value>0&&(t.type==="percent"?c=o*t.value/100:c=t.value,c>o&&(c=o),m=o-c);let d=0,p=m;return a.baseVatRate>0&&(d=m*a.baseVatRate/100,p=m+d),{grandTotal:Math.round(o*100)/100,discountAmount:Math.round(c*100)/100,afterDiscount:Math.round(m*100)/100,vatAmount:Math.round(d*100)/100,finalTotal:Math.round(p*100)/100,roomTotals:l}},[s,t,a])};function b(...s){return cs(ds(s))}const dt=({children:s,onOpenMainMenu:t,onOpenDiscount:a,onOpenOverview:r})=>{const l=k(p=>p.shopConfig),o=k(p=>p.addRoom),{finalTotal:m}=ue(),[c,x]=f.useState(!1);f.useEffect(()=>{const p=()=>x(window.scrollY>10);return window.addEventListener("scroll",p),()=>window.removeEventListener("scroll",p)},[]);const d=()=>{o(),setTimeout(()=>window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),100)};return e.jsxs("div",{className:"min-h-screen relative transition-colors duration-500 overflow-x-hidden pb-[100px]",children:[e.jsxs("div",{className:"fixed inset-0 z-0 pointer-events-none overflow-hidden",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[70vw] h-[70vw] bg-violet-600/15 dark:bg-[#5B21B6]/20 rounded-full blur-[100px] mix-blend-multiply dark:mix-blend-screen animate-pulse duration-[12000ms]"}),e.jsx("div",{className:"absolute top-[30%] right-[-20%] w-[60vw] h-[60vw] bg-fuchsia-500/15 dark:bg-[#86198F]/15 rounded-full blur-[120px] mix-blend-multiply dark:mix-blend-screen animate-pulse duration-[18000ms]"}),e.jsx("div",{className:"absolute bottom-[-10%] left-[20%] w-[40vw] h-[40vw] bg-amber-300/15 dark:bg-[#D97706]/10 rounded-full blur-[90px] mix-blend-multiply dark:mix-blend-screen"})]}),e.jsx("nav",{className:b("fixed top-0 left-0 right-0 z-40 transition-all duration-300 ease-ios px-4 py-2",c?"bg-white/60 dark:bg-[#0D0814]/60 backdrop-blur-xl border-b border-violet-100/50 dark:border-white/5 shadow-sm":"bg-transparent"),children:e.jsxs("div",{className:"max-w-3xl mx-auto flex items-center justify-between h-12",children:[e.jsxs("button",{onClick:t,"aria-label":"Open Main Menu",className:"flex items-center gap-3 group active:scale-95 transition-transform max-w-[60%]",children:[e.jsxs("div",{className:"relative w-10 h-10 rounded-xl bg-white/50 dark:bg-white/5 shadow-sm border border-white/20 flex items-center justify-center overflow-hidden shrink-0 backdrop-blur-sm",children:[l.logoUrl?e.jsx("img",{src:l.logoUrl,alt:"Logo",className:"w-full h-full object-cover"}):e.jsx(Ie,{className:"w-5 h-5 text-violet-700 dark:text-violet-300"}),e.jsx("div",{className:"absolute inset-0 bg-black/5 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(xs,{className:"w-4 h-4 text-slate-800 dark:text-white drop-shadow-md"})})]}),e.jsx("div",{className:"flex flex-col items-start overflow-hidden",children:e.jsx("span",{className:b("font-bold text-lg tracking-tight leading-none truncate w-full text-left","text-slate-900 dark:text-white"),children:l.name||"Marnthara"})})]}),e.jsx("button",{onClick:a,"aria-label":"View Discount and Total",className:"relative group active:scale-95 transition-transform",children:e.jsx("div",{className:"h-10 pl-4 pr-4 rounded-xl flex items-center shadow-[0_4px_15px_rgba(124,58,237,0.2)] transition-all border border-violet-500/20 bg-violet-900/10 dark:bg-white/5 backdrop-blur-md",children:e.jsxs("div",{className:"flex flex-col items-end leading-none",children:[e.jsx("span",{className:"text-[10px] font-medium opacity-70 text-violet-900 dark:text-violet-200",children:"ยอดสุทธิ"}),e.jsx("span",{className:"font-mono font-bold text-lg tracking-tight text-violet-700 dark:text-violet-100 drop-shadow-[0_0_8px_rgba(167,139,250,0.5)]",children:F(m)})]})})})]})}),e.jsx("main",{className:"relative z-10 pt-20 px-4 max-w-3xl mx-auto space-y-6",children:s}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 pb-safe-area pointer-events-none",children:e.jsx("div",{className:"bg-white/80 dark:bg-[#120B1F]/80 backdrop-blur-2xl border-t border-white/20 dark:border-white/10 shadow-[0_-10px_40px_rgba(0,0,0,0.3)] pointer-events-auto",children:e.jsxs("div",{className:"max-w-md mx-auto h-[70px] grid grid-cols-5 items-center px-2",children:[e.jsxs("button",{onClick:r,"aria-label":"Project Overview",className:"flex flex-col items-center justify-center gap-1 group active:scale-90 transition-transform h-full",children:[e.jsx("div",{className:"p-2 rounded-xl group-hover:bg-violet-50 dark:group-hover:bg-white/5 transition-colors",children:e.jsx(ms,{className:"w-6 h-6 text-slate-400 dark:text-slate-500 group-hover:text-violet-600 dark:group-hover:text-violet-300 transition-colors"})}),e.jsx("span",{className:"text-[9px] font-medium text-slate-400 dark:text-slate-500 group-hover:text-violet-600 dark:group-hover:text-violet-300",children:"ภาพรวม"})]}),e.jsx("button",{"aria-label":"Search (Disabled)",className:"flex flex-col items-center justify-center gap-1 opacity-30 cursor-not-allowed h-full",children:e.jsx(hs,{className:"w-6 h-6 text-slate-400"})}),e.jsx("div",{className:"relative -top-6 flex justify-center",children:e.jsxs("button",{onClick:d,"aria-label":"Add New Room",className:"w-16 h-16 rounded-full bg-gradient-to-tr from-violet-600 to-fuchsia-600 text-white shadow-[0_8px_25px_rgba(124,58,237,0.5)] flex items-center justify-center active:scale-90 transition-transform border-4 border-white dark:border-[#120B1F] group",children:[e.jsx(te,{className:"w-8 h-8 group-hover:rotate-90 transition-transform duration-300",strokeWidth:2.5}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-white/20 blur-md opacity-0 group-hover:opacity-100 transition-opacity"})]})}),e.jsx("button",{"aria-label":"Favorites (Disabled)",className:"flex flex-col items-center justify-center gap-1 opacity-30 cursor-not-allowed h-full",children:e.jsx(ae,{className:"w-6 h-6 text-slate-400"})}),e.jsx("button",{"aria-label":"Settings (Disabled)",className:"flex flex-col items-center justify-center gap-1 opacity-30 cursor-not-allowed h-full",children:e.jsx($e,{className:"w-6 h-6 text-slate-400"})})]})})})]})},O=we(s=>({toasts:[],addToast:(t,a,r)=>{const l=Math.random().toString(36).substring(2,9);s(o=>({toasts:[...o.toasts,{id:l,type:t,title:a,message:r}]})),setTimeout(()=>{s(o=>({toasts:o.toasts.filter(m=>m.id!==l)}))},3e3)},removeToast:t=>s(a=>({toasts:a.toasts.filter(r=>r.id!==t)})),alertConfig:{isOpen:!1,title:"",description:"",variant:"default",confirmLabel:"ตกลง",cancelLabel:"ยกเลิก",onConfirm:()=>{},onCancel:()=>{}},openAlert:t=>s(a=>({alertConfig:{...a.alertConfig,...t,isOpen:!0}})),closeAlert:()=>s(t=>({alertConfig:{...t.alertConfig,isOpen:!1}}))})),ke=()=>{const s=O(a=>a.openAlert);return{confirm:a=>new Promise(r=>{s({...a,onConfirm:()=>r(!0),onCancel:()=>r(!1)})})}},ts=()=>({trigger:f.useCallback((t="selection")=>{if(!(typeof navigator>"u"||!navigator.vibrate))switch(t){case"light":navigator.vibrate(5);break;case"medium":navigator.vibrate(10);break;case"heavy":navigator.vibrate(15);break;case"selection":navigator.vibrate(3);break;case"success":navigator.vibrate([10,30,10]);break;case"warning":navigator.vibrate([30,50,10]);break;case"error":navigator.vibrate([50,100,50,100]);break;default:navigator.vibrate(10)}},[])}),C=({className:s,variant:t="primary",size:a="md",disableHaptic:r=!1,onClick:l,ref:o,...m})=>{const{trigger:c}=ts(),x=u=>{r||c(t==="destructive"?"warning":"light"),l?.(u)},d={primary:"bg-slate-900 text-white hover:bg-slate-800 shadow-sm active:scale-[0.96] border border-transparent",secondary:"bg-white text-slate-900 border border-slate-200 hover:bg-slate-50 hover:border-slate-300 shadow-sm active:scale-[0.96]",outline:"border border-slate-200 bg-transparent hover:bg-slate-50 text-slate-600 active:scale-[0.96]",ghost:"hover:bg-slate-100 text-slate-500 hover:text-slate-900 active:scale-[0.96] border border-transparent",destructive:"bg-red-50 text-red-600 hover:bg-red-100 border border-red-100 active:scale-[0.96]"},p={sm:"h-8 px-3 text-xs rounded-lg",md:"h-12 px-5 py-2 rounded-xl text-sm font-medium",lg:"h-14 px-8 rounded-2xl text-base font-medium",icon:"h-11 w-11 p-0 rounded-full flex items-center justify-center"};return e.jsx("button",{ref:o,onClick:x,className:b("inline-flex items-center justify-center whitespace-nowrap focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 select-none","transition-all duration-200 ease-[var(--ease-ios)]",d[t],p[a],s),...m})},xt=({item:s,index:t,roomId:a,onEdit:r})=>{const l=k(i=>i.removeItem),o=k(i=>i.duplicateItem),m=k(i=>i.updateItem),{confirm:c}=ke(),x=O(i=>i.addToast),d=T.getItemPrice(s),p=f.useMemo(()=>{let i="";return s.type==="curtain"&&"style"in s?i=`ม่าน${s.style}`:(s.type,i=U[s.type]?.name||"สินค้า"),i.replace(/\s*\(.*?\)\s*/g,"").trim()},[s]),u=f.useMemo(()=>"width_m"in s&&"height_m"in s?`${I(s.width_m)} × ${I(s.height_m)}`:"quantity"in s?`${s.quantity}`:"",[s]),h=f.useMemo(()=>"fabric_variant"in s&&s.fabric_variant?s.fabric_variant.replace(/\s*\(.*?\)\s*/g,"").trim():"",[s]),g=f.useMemo(()=>d.toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:0}),[d]),j=(t+1).toString().padStart(2,"0"),_=async()=>{await c({title:"ลบรายการ",description:"คุณต้องการลบรายการนี้ใช่หรือไม่?",variant:"destructive",confirmLabel:"ลบรายการ"})&&(l(a,s.id),x("success","ลบรายการเรียบร้อยแล้ว"))},y=()=>{m(a,s.id,{is_suspended:!s.is_suspended})};return e.jsxs("div",{className:b("relative flex items-start gap-3 py-3 px-3 border-b last:border-0 border-slate-100 transition-all cursor-pointer rounded-lg active:bg-slate-100","hover:bg-slate-50",s.is_suspended&&"opacity-60 grayscale bg-slate-50"),onClick:r,children:[e.jsx("div",{className:"pt-0.5",children:e.jsx("div",{className:b("flex h-7 w-7 items-center justify-center rounded-lg text-[12px] font-bold font-mono border",s.is_suspended?"bg-slate-100 text-slate-400 border-slate-200":"bg-white text-slate-600 border-slate-200 shadow-sm"),children:j})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("span",{className:b("text-[15px] font-semibold text-slate-900 truncate leading-tight",s.is_suspended&&"line-through text-slate-500"),children:p}),e.jsx("span",{className:b("text-[15px] font-mono font-bold tracking-tight shrink-0 leading-tight",s.is_suspended?"text-slate-400":"text-slate-700 dark:text-slate-300"),children:g})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[13px] text-slate-600 font-medium leading-tight",children:[h&&e.jsx("span",{className:"truncate max-w-[140px]",children:h}),h&&u&&e.jsx("span",{className:"text-slate-300",children:"|"}),u&&e.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-400 bg-slate-100 dark:bg-slate-800 px-1.5 rounded text-[12px]",children:u})]})]}),e.jsx("div",{className:"shrink-0 pl-1 pt-0.5",onClick:i=>i.stopPropagation(),children:e.jsxs(Ye,{children:[e.jsx(Je,{className:"flex h-8 w-8 items-center justify-center rounded-lg text-slate-400 hover:text-slate-600 hover:bg-slate-100 active:bg-slate-200 transition-colors focus:outline-none","aria-label":"ตัวเลือก",children:e.jsx(Le,{className:"w-5 h-5"})}),e.jsx(W,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsxs(Ze,{anchor:"bottom end",className:"z-[999] w-44 origin-top-right rounded-xl bg-white dark:bg-[#1E1030] p-1 shadow-xl ring-1 ring-black/5 dark:ring-white/10 focus:outline-none border border-slate-100 dark:border-slate-700/50",children:[e.jsx("div",{className:"px-3 py-2 border-b border-slate-100 dark:border-slate-700/50 mb-1",children:e.jsx("p",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-wider truncate",children:p})}),e.jsx(z,{children:({focus:i})=>e.jsxs("button",{onClick:()=>r(),className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium transition-colors",i?"bg-violet-50 text-violet-700 dark:bg-white/10 dark:text-violet-200":"text-slate-700 dark:text-slate-300"),children:[e.jsx(ps,{className:"w-4 h-4"})," แก้ไข"]})}),e.jsx(z,{children:({focus:i})=>e.jsxs("button",{onClick:()=>o(a,s.id),className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium transition-colors",i?"bg-violet-50 text-violet-700 dark:bg-white/10 dark:text-violet-200":"text-slate-700 dark:text-slate-300"),children:[e.jsx(Oe,{className:"w-4 h-4"})," คัดลอก"]})}),e.jsx("div",{className:"h-px bg-slate-100 dark:bg-slate-700/50 my-1"}),e.jsx(z,{children:({focus:i})=>e.jsxs("button",{onClick:y,className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium transition-colors",i?"bg-amber-50 text-amber-700 dark:bg-amber-500/10 dark:text-amber-400":"text-slate-700 dark:text-slate-300"),children:[s.is_suspended?e.jsx(Ee,{className:"w-4 h-4 text-green-600"}):e.jsx(fe,{className:"w-4 h-4 text-amber-500"}),s.is_suspended?"เปิดใช้งาน":"ซ่อนรายการ"]})}),e.jsx("div",{className:"h-px bg-slate-100 dark:bg-slate-700/50 my-1"}),e.jsx(z,{children:({focus:i})=>e.jsxs("button",{onClick:_,className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium text-red-600 transition-colors",i?"bg-red-50 dark:bg-red-500/10":""),children:[e.jsx(Re,{className:"w-4 h-4"})," ลบรายการ"]})})]})})]})})]})},w=({className:s,label:t,suffix:a,prefix:r,isDimension:l=!1,id:o,ref:m,value:c,onChange:x,onClear:d,onBlur:p,type:u="text",error:h,...g})=>{const j=f.useId(),_=o||j,y=f.useRef(null),i=m||y,n=A=>{if(l&&x){const P=A.target.value,D=ss(P);if(D!==P&&D!==""){const J={...A,target:{...A.target,value:D}};x(J)}}p?.(A)},v=A=>{A.preventDefault(),A.stopPropagation(),d&&d(),i.current?.focus()},M=d&&c&&String(c).length>0;return e.jsxs("div",{className:"w-full space-y-1.5",children:[t&&e.jsx("label",{htmlFor:_,className:"text-[15px] font-medium text-slate-700 ml-1",children:t}),e.jsxs("div",{className:"relative",children:[r&&e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none z-10",children:r}),e.jsx("input",{ref:i,id:_,type:u,inputMode:l?"decimal":g.inputMode,value:c,onChange:x,onBlur:n,autoComplete:"off","data-lpignore":"true",className:b("flex h-12 w-full rounded-xl border bg-white px-4 py-2 text-[16px] text-slate-900","placeholder:text-slate-400","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:border-transparent","disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-slate-50","transition-all shadow-sm appearance-none",h?"border-red-500 focus-visible:ring-red-500 bg-red-50/30":"border-slate-200",a?"pr-12":M?"pr-10":"",r?"pl-10":"",s),...g}),a&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm font-medium pointer-events-none",children:a}),M&&!a&&e.jsx("button",{type:"button",onClick:v,tabIndex:-1,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 rounded-full text-slate-400 hover:bg-slate-100 hover:text-slate-600 transition-colors",children:e.jsx(ne,{className:"w-4 h-4"})})]}),h&&e.jsxs("div",{className:"flex items-center gap-1.5 px-1 animate-fade-in",children:[e.jsx(De,{className:"w-3.5 h-3.5 text-red-500"}),e.jsx("span",{className:"text-xs font-medium text-red-500",children:h})]})]})},mt=({room:s,index:t,totalRooms:a,onAddItem:r,onEditItem:l,onOpenDefaults:o})=>{const[m,c]=f.useState(!0),[x,d]=f.useState(!1),[p,u]=f.useState(s.name),h=k(S=>S.updateRoom),g=k(S=>S.removeRoom),j=k(S=>S.duplicateRoom),_=k(S=>S.toggleRoomSuspension),{confirm:y}=ke(),i=O(S=>S.addToast),n=f.useMemo(()=>s.is_suspended?0:s.items.reduce((S,q)=>S+T.getItemPrice(q),0),[s.items,s.is_suspended]),v=f.useMemo(()=>n.toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:0}),[n]),M=s.items.length,A=(t+1).toString().padStart(2,"0"),P=a.toString().padStart(2,"0"),D=()=>{p.trim()&&(h(s.id,{name:p}),d(!1))},J=S=>{S.key==="Enter"&&D(),S.key==="Escape"&&(u(s.name),d(!1))},be=async()=>{await y({title:"ลบห้อง",description:`คุณต้องการลบ "${s.name}" และรายการทั้งหมดใช่หรือไม่?`,variant:"destructive",confirmLabel:"ลบห้อง"})&&(g(s.id),i("success","สำเร็จ","ลบห้องเรียบร้อยแล้ว"))};return e.jsxs("div",{className:b("group relative rounded-2xl border transition-all duration-300",s.is_suspended?"border-slate-100 bg-slate-50/50 opacity-80":"bg-white border-slate-200 shadow-sm hover:shadow-md hover:border-violet-300 dark:hover:border-violet-500"),children:[e.jsxs("div",{className:"p-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer select-none gap-3",onClick:()=>!x&&c(!m),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsxs("div",{className:b("flex shrink-0 items-center justify-center px-2 py-0.5 rounded-md text-[12px] font-bold font-mono tracking-wide border",s.is_suspended?"bg-slate-100 text-slate-400 border-slate-200":"bg-slate-100 text-slate-600 border-slate-200"),children:[A,"/",P]}),e.jsx("div",{className:"flex-1 min-w-0",children:x?e.jsx("div",{onClick:S=>S.stopPropagation(),children:e.jsx(w,{autoFocus:!0,value:p,onChange:S=>u(S.target.value),onBlur:D,onKeyDown:J,className:"h-9 text-[17px] font-bold","aria-label":"แก้ไขชื่อห้อง"})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:b("text-[17px] font-bold tracking-tight truncate text-slate-900",s.is_suspended&&"text-slate-400 line-through decoration-slate-300"),children:s.name}),e.jsx("button",{onClick:S=>{S.stopPropagation(),d(!0)},className:"opacity-0 group-hover:opacity-100 focus:opacity-100 p-1.5 text-slate-400 hover:text-violet-600 transition-opacity rounded","aria-label":"แก้ไขชื่อห้อง",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]}),e.jsx("div",{className:"text-right shrink-0",children:e.jsx("div",{className:b("text-[17px] font-mono font-bold tracking-tight",s.is_suspended?"text-slate-400":"text-violet-600 dark:text-violet-400"),children:v})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1 border-t border-transparent",children:[e.jsx("div",{className:b("text-[12px] font-medium flex items-center gap-1.5",s.is_suspended?"text-amber-600":"text-slate-500"),children:s.is_suspended?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-3.5 h-3.5"})," พักการใช้งาน"]}):e.jsx(e.Fragment,{children:e.jsxs("span",{className:"bg-slate-100 px-2 py-0.5 rounded-full text-slate-600",children:[M," รายการ"]})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{size:"sm",variant:"secondary",className:"h-9 px-3 text-[12px] font-medium gap-1.5 shadow-sm border-slate-200 hover:border-violet-200 hover:text-violet-600 hover:bg-violet-50",onClick:()=>r(s.id),children:[e.jsx(te,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden xs:inline",children:"เพิ่มรายการ"}),e.jsx("span",{className:"inline xs:hidden",children:"เพิ่ม"})]}),e.jsxs(Ye,{children:[e.jsx(Je,{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-white border border-slate-200 text-slate-400 hover:text-slate-600 hover:bg-slate-50 focus:outline-none active:bg-slate-100 transition-colors","aria-label":"ตัวเลือกเมนู",children:e.jsx(Le,{className:"w-5 h-5"})}),e.jsx(W,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsxs(Ze,{anchor:"bottom end",modal:!1,className:"z-[999] w-56 origin-top-right rounded-xl bg-white dark:bg-[#1E1030] p-2 shadow-xl ring-1 ring-black/5 dark:ring-white/10 focus:outline-none border border-slate-100 dark:border-slate-700/50",children:[e.jsx("div",{className:"px-3 py-2 border-b border-slate-100 dark:border-slate-700/50 mb-1",children:e.jsxs("p",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:["จัดการ: ",s.name]})}),e.jsx(z,{children:({focus:S})=>e.jsxs("button",{onClick:()=>o(s.id),className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium transition-colors",S?"bg-violet-50 text-violet-700 dark:bg-white/10 dark:text-violet-200":"text-slate-700 dark:text-slate-300"),children:[e.jsx(ze,{className:"w-4 h-4 text-slate-400"})," ตั้งค่าเริ่มต้น"]})}),e.jsx(z,{children:({focus:S})=>e.jsxs("button",{onClick:()=>j(s.id),className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium transition-colors",S?"bg-violet-50 text-violet-700 dark:bg-white/10 dark:text-violet-200":"text-slate-700 dark:text-slate-300"),children:[e.jsx(Oe,{className:"w-4 h-4 text-slate-400"})," คัดลอกห้อง"]})}),e.jsx("div",{className:"my-1 h-px bg-slate-100 dark:bg-slate-700/50"}),e.jsx(z,{children:({focus:S})=>e.jsxs("button",{onClick:()=>_(s.id),className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium transition-colors",S?"bg-amber-50 text-amber-700 dark:bg-amber-500/10 dark:text-amber-400":"text-slate-700 dark:text-slate-300"),children:[s.is_suspended?e.jsx(Ee,{className:"w-4 h-4 text-green-500"}):e.jsx(fe,{className:"w-4 h-4 text-amber-500"}),s.is_suspended?"แสดงห้อง (Active)":"ซ่อน/พัก (Suspend)"]})}),e.jsx("div",{className:"my-1 h-px bg-slate-100 dark:bg-slate-700/50"}),e.jsx(z,{children:({focus:S})=>e.jsxs("button",{onClick:be,className:b("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-[13px] font-medium text-red-600 transition-colors",S?"bg-red-50 dark:bg-red-500/10":""),children:[e.jsx(Re,{className:"w-4 h-4"})," ลบห้องนี้"]})})]})})]})]})]})]}),e.jsx("div",{className:b("overflow-hidden transition-all duration-300 ease-in-out",m?"max-h-[5000px] opacity-100 border-t border-slate-100":"max-h-0 opacity-0"),children:e.jsx("div",{className:"p-2 sm:p-3 space-y-2 bg-slate-50/50 rounded-b-2xl",children:M===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center cursor-pointer active:scale-95 transition-transform",onClick:()=>r(s.id),children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-white border border-slate-200 flex items-center justify-center mb-2 shadow-sm",children:e.jsx(Be,{className:"w-6 h-6 text-slate-300"})}),e.jsx("p",{className:"text-[13px] text-slate-500 font-medium",children:"แตะเพื่อเพิ่มรายการแรก"})]}):e.jsxs(e.Fragment,{children:[s.items.map((S,q)=>e.jsx(xt,{item:S,index:q,roomId:s.id,onEdit:()=>l(s.id,S)},S.id)),e.jsxs("button",{onClick:()=>r(s.id),className:"w-full py-3.5 mt-2 flex items-center justify-center gap-2 rounded-xl border border-dashed border-slate-300 bg-white/50 text-[13px] font-medium text-slate-500 hover:text-violet-600 hover:border-violet-300 hover:bg-violet-50/50 transition-all active:scale-[0.98]",children:[e.jsx(te,{className:"w-4 h-4"})," เพิ่มรายการสินค้า"]})]})})})]})},as=we()(Ae(s=>({theme:"light",toggleTheme:()=>s(t=>{const a=t.theme==="light"?"dark":"light";return ge(a),{theme:a}}),setTheme:t=>{ge(t),s({theme:t})}}),{name:"marnthara-theme",storage:Pe(()=>localStorage),onRehydrateStorage:()=>s=>{s&&ge(s.theme)}})),ge=s=>{const t=window.document.documentElement;t.classList.remove("light","dark"),t.classList.add(s);const a=document.querySelector('meta[name="theme-color"]');a&&a.setAttribute("content",s==="dark"?"#0D0814":"#FBFBFE")},ht=({toast:s,onDismiss:t})=>{const a={success:e.jsx("div",{className:"bg-green-500 rounded-full p-1",children:e.jsx(se,{className:"w-3 h-3 text-white",strokeWidth:4})}),error:e.jsx(De,{className:"w-5 h-5 text-red-400"}),warning:e.jsx(ie,{className:"w-5 h-5 text-amber-400"}),info:e.jsx(us,{className:"w-5 h-5 text-blue-400"})};return e.jsx(W,{show:!0,appear:!0,enter:"transform ease-out duration-300 transition",enterFrom:"translate-y-[-150%] opacity-0 scale-90",enterTo:"translate-y-0 opacity-100 scale-100",leave:"transition ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"translate-y-[-150%] opacity-0 scale-90",children:e.jsxs("div",{className:b("pointer-events-auto flex items-center gap-3 px-4 py-3 shadow-2xl mb-3 cursor-pointer select-none","bg-[#1A1A1A]/95 backdrop-blur-md border border-white/10","rounded-full min-w-[200px] max-w-[90vw]","text-white"),onClick:()=>t(s.id),children:[e.jsx("div",{className:"shrink-0 flex items-center",children:a[s.type]}),e.jsxs("div",{className:"flex-1 min-w-0 text-center sm:text-left mr-2",children:[e.jsx("p",{className:"text-[14px] font-semibold leading-tight tracking-tight",children:s.title}),s.message&&e.jsx("p",{className:"text-[12px] text-white/70 mt-0.5 truncate max-w-[240px]",children:s.message})]})]})})},pt=()=>{const s=O(a=>a.toasts),t=O(a=>a.removeToast);return s.length===0?null:ns.createPortal(e.jsx("div",{className:"fixed top-4 left-0 right-0 z-[200] flex flex-col items-center pointer-events-none pt-safe-area",children:s.map(a=>e.jsx(ht,{toast:a,onDismiss:t},a.id))}),document.body)},ut=()=>{const{isOpen:s,title:t,description:a,variant:r,confirmLabel:l,cancelLabel:o,onConfirm:m,onCancel:c}=O(p=>p.alertConfig),x=O(p=>p.closeAlert),d=p=>{x(),p?m():c()};return e.jsx(W,{show:s,as:f.Fragment,children:e.jsxs(he,{onClose:()=>d(!1),className:"relative z-[110]",children:[e.jsx(B,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-[2px]"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(B,{as:f.Fragment,enter:"ease-ios duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(pe,{className:"w-full max-w-sm transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[r==="destructive"&&e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(ie,{className:"w-5 h-5 text-red-600"})}),e.jsx("div",{children:e.jsx(_e,{as:"h3",className:"text-lg font-bold leading-6 text-slate-900",children:t})})]}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-slate-500",children:a})}),e.jsxs("div",{className:"mt-6 flex gap-3 justify-end",children:[e.jsx(C,{variant:"ghost",onClick:()=>d(!1),children:o}),e.jsx(C,{variant:r==="destructive"?"destructive":"primary",onClick:()=>d(!0),children:l})]})]})})})})]})})},bt=(s,t)=>{f.useEffect(()=>{if(s){window.history.pushState({modalOpen:!0},"",window.location.href);const a=r=>{r.preventDefault(),t()};return window.addEventListener("popstate",a),()=>{window.removeEventListener("popstate",a)}}},[s,t])},E=({isOpen:s,onClose:t,title:a,children:r,footer:l,maxWidth:o="lg"})=>{bt(s,t);const m={sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl"};return e.jsx(W,{show:s,as:f.Fragment,children:e.jsxs(he,{onClose:t,className:"relative z-50",children:[e.jsx(B,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-[2px]"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center sm:p-0",children:e.jsx(B,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsxs(pe,{className:b("relative w-full transform overflow-hidden rounded-2xl bg-white text-left align-middle shadow-xl transition-all flex flex-col max-h-[85vh]",m[o]),children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-3 sm:px-6 sm:py-4 border-b border-slate-100 shrink-0",children:[e.jsx(_e,{className:"text-lg sm:text-xl font-bold text-slate-900 tracking-tight line-clamp-1",children:a}),e.jsx("button",{onClick:t,className:"bg-slate-100 text-slate-500 hover:text-slate-900 transition-colors p-2 rounded-full active:bg-slate-200 active:scale-95 focus:outline-none",children:e.jsx(ne,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-5 sm:p-6 overscroll-contain pb-safe-area",children:e.jsx("div",{className:b("space-y-4",l?"pb-20 sm:pb-0":""),children:r})}),l&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 sm:relative px-5 py-4 sm:px-6 border-t border-slate-100 bg-white/95 backdrop-blur-sm pb-safe-area sm:pb-4 shrink-0 z-20 rounded-b-none sm:rounded-b-2xl",children:l})]})})})})]})})},gt=s=>{if(s===""||s===void 0||s===0)return"";const t=Number(s);return isNaN(t)?"":t.toLocaleString("en-US")},ft=s=>s.replace(/,/g,""),X=(s,t)=>{const[a,r]=f.useState(s),[l,o]=f.useState({}),m=f.useMemo(()=>JSON.stringify(a)!==JSON.stringify(s),[a,s]),c=f.useCallback((h,g)=>{r(j=>({...j,[h]:g})),t&&t[h]&&o(j=>({...j,[h]:void 0}))},[t]),x=f.useCallback((h,g)=>{const j=ft(g);/^\d*\.?\d*$/.test(j)&&(r(_=>({..._,[h]:j})),t&&t[h]&&o(_=>({..._,[h]:void 0})))},[t]),d=f.useCallback(()=>{if(!t)return!0;const h={};let g=!0;return Object.keys(t).forEach(j=>{const _=t[j];if(_){const y=_(a[j],a);y&&(h[j]=y,g=!1)}}),o(h),g},[a,t]),p=f.useCallback(h=>{const g=a[h];return gt(g)},[a]),u=f.useCallback(()=>{r(s),o({})},[s]);return{formData:a,errors:l,isDirty:m,handleChange:c,handleNumberChange:x,getFormattedNumber:p,setFormData:r,validate:d,resetForm:u}},ls=K.forwardRef(({className:s,label:t,valueLabel:a,placeholder:r="เลือก...",hasError:l,id:o,...m},c)=>{const x=f.useId(),d=o||x;return e.jsxs("div",{className:"space-y-1.5 w-full",children:[t&&e.jsx("label",{htmlFor:d,className:"text-[15px] font-medium text-slate-700 ml-1",children:t}),e.jsxs("button",{ref:c,id:d,type:"button",className:b("flex h-12 w-full items-center justify-between rounded-xl border bg-white px-4 py-2 text-[16px] transition-all shadow-sm active:scale-[0.99]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:border-transparent",l?"border-red-500 focus-visible:ring-red-500":"border-slate-200",a?"text-slate-900":"text-slate-400",s),...m,children:[e.jsx("span",{className:"truncate",children:a||r}),e.jsx(bs,{className:"w-4 h-4 text-slate-400 shrink-0 ml-2"})]})]})});ls.displayName="SelectButton";const jt=({isOpen:s,onClose:t,title:a,options:r,value:l,onSelect:o})=>{const{trigger:m}=ts(),c=x=>{x!==l&&(m("selection"),o(x)),setTimeout(()=>{t()},150)};return e.jsx(W,{show:s,as:f.Fragment,children:e.jsxs(he,{onClose:t,className:"relative z-[60]",children:[e.jsx(B,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-[2px]","aria-hidden":"true"})}),e.jsx("div",{className:"fixed inset-0 flex items-end justify-center pointer-events-none",children:e.jsx(B,{as:f.Fragment,enter:"transform transition ease-ios duration-300",enterFrom:"translate-y-full",enterTo:"translate-y-0",leave:"transform transition ease-ios duration-200",leaveFrom:"translate-y-0",leaveTo:"translate-y-full",children:e.jsxs(pe,{className:"pointer-events-auto w-full max-w-md bg-white rounded-t-[28px] shadow-2xl overflow-hidden flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 bg-white/80 backdrop-blur-md sticky top-0 z-10",children:[e.jsx(_e,{className:"text-lg font-bold text-slate-900",children:a}),e.jsx("button",{onClick:t,className:"p-2 -mr-2 rounded-full text-slate-400 hover:bg-slate-100 hover:text-slate-600 transition-colors",children:e.jsx(ne,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"overflow-y-auto p-4 space-y-2 pb-safe-area",children:r.map(x=>{const d=x.value===l,p=x.icon;return e.jsxs("button",{onClick:()=>c(x.value),className:b("w-full flex items-center p-4 rounded-2xl transition-all duration-200 border-2 text-left group active:scale-[0.98]",d?"border-slate-900 bg-slate-50":"border-transparent bg-white hover:bg-slate-50"),children:[p&&e.jsx("div",{className:b("w-10 h-10 rounded-full flex items-center justify-center mr-4 transition-colors",d?"bg-slate-900 text-white":"bg-slate-100 text-slate-500"),children:e.jsx(p,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:b("font-semibold text-[15px]",d?"text-slate-900":"text-slate-700"),children:x.label}),x.description&&e.jsx("div",{className:"text-xs text-slate-500 mt-0.5 font-normal",children:x.description})]}),d&&e.jsx("div",{className:"ml-3 text-slate-900",children:e.jsx(se,{className:"w-5 h-5"})})]},String(x.value))})})]})})})]})})},L=({className:s,checked:t,onCheckedChange:a,disabled:r,ref:l,...o})=>e.jsxs("label",{className:b("group inline-flex items-center relative cursor-pointer tap-highlight-transparent",r&&"cursor-not-allowed opacity-50",s),children:[e.jsx("input",{ref:l,type:"checkbox",className:"sr-only",checked:t,onChange:m=>a(m.target.checked),disabled:r,...o}),e.jsx("div",{className:b("w-[51px] h-[31px] rounded-full transition-colors duration-300 ease-in-out border",t?"bg-[#34C759] border-[#34C759]":"bg-[#E9E9EA] border-[#E5E5EA]")}),e.jsx("div",{className:b("absolute left-[2px] top-[2px] w-[27px] h-[27px] bg-white rounded-full shadow-[0_2px_4px_rgba(0,0,0,0.2)]","transform transition-transform duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)",t?"translate-x-[20px]":"translate-x-0")})]}),V=({category:s,currentValue:t,onSelect:a})=>{const[r,l]=f.useState(!1),o=k(d=>d.favorites),m=k(d=>d.addFavorite),c=o[s]||[],x=()=>{!t||!t.code||(m(s,t),l(!1))};return e.jsxs("div",{className:"relative inline-block",children:[e.jsx(C,{type:"button",variant:"ghost",size:"sm",className:b("h-8 px-2 gap-1 text-slate-400 hover:text-amber-500",c.length>0&&"text-amber-500"),onClick:()=>l(!r),title:"รายการโปรด",children:e.jsx(je,{className:b("w-4 h-4",r&&"fill-current")})}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-xl shadow-xl border border-slate-100 z-50 animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-3 border-b border-slate-100 flex justify-between items-center bg-slate-50 rounded-t-xl",children:[e.jsxs("span",{className:"text-xs font-bold text-slate-500",children:["รายการโปรด (",c.length,")"]}),e.jsx("button",{onClick:()=>l(!1),children:e.jsx(ne,{className:"w-3 h-3 text-slate-400"})})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto p-2 space-y-1",children:c.length===0?e.jsx("div",{className:"text-center py-4 text-xs text-slate-400",children:"ว่างเปล่า"}):c.map(d=>e.jsxs("button",{onClick:()=>{a({code:d.code,price:d.price}),l(!1)},className:"w-full text-left px-3 py-2 hover:bg-blue-50 rounded-lg text-sm flex justify-between items-center group",children:[e.jsx("span",{className:"font-medium text-slate-700 truncate",children:d.code}),d.price>0&&e.jsx("span",{className:"text-xs text-slate-400 group-hover:text-blue-600",children:F(d.price)})]},d.id))}),t&&t.code&&e.jsx("div",{className:"p-2 border-t border-slate-100",children:e.jsxs("button",{onClick:x,className:"w-full flex items-center justify-center gap-2 text-xs text-blue-600 hover:bg-blue-50 py-2 rounded-lg transition-colors",children:[e.jsx(te,{className:"w-3 h-3"}),' บันทึก "',t.code,'"']})})]})]})]})},H=({label:s,placeholder:t,value:a,onChange:r,onSelect:l,options:o,className:m,inputMode:c,prefix:x,suffix:d,isDimension:p=!1,id:u})=>{const[h,g]=f.useState(""),j=f.useId(),_=u||j,y=h===""?o:o.filter(n=>n.label.toLowerCase().includes(h.toLowerCase())||n.desc&&n.desc.toLowerCase().includes(h.toLowerCase())),i=n=>{if(p){const v=n.target.value,M=ss(v);M&&M!==v&&(r(M),g(M))}};return e.jsxs("div",{className:b("space-y-1.5 w-full",m),children:[s&&e.jsx("label",{htmlFor:_,className:"text-[15px] font-medium text-slate-700 ml-1",children:s}),e.jsx(Xs,{value:a,onChange:n=>{if(n){r(n);const v=o.find(M=>M.value===n);v&&l&&l(v.data)}},immediate:!0,children:e.jsxs("div",{className:"relative",children:[x&&e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none z-10",children:x}),e.jsx(Gs,{id:_,className:b("flex h-12 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-[16px] text-slate-900","placeholder:text-slate-400","focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent","transition-all shadow-sm",x?"pl-10":"",d?"pr-12":"pr-10"),placeholder:t,onChange:n=>{g(n.target.value),r(n.target.value)},onBlur:i,inputMode:c||(p?"decimal":"text"),autoComplete:"off"}),e.jsx(Ks,{className:"absolute inset-y-0 right-0 flex items-center px-2 text-slate-400 hover:text-slate-600",children:e.jsx(gs,{className:"h-4 w-4","aria-hidden":"true"})}),d&&e.jsx("div",{className:"absolute right-8 top-1/2 -translate-y-1/2 text-slate-400 text-sm font-medium pointer-events-none",children:d}),e.jsx(W,{as:f.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",afterLeave:()=>g(""),children:e.jsx(Qs,{className:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-xl bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none sm:text-sm empty:invisible",children:y.length===0&&h!==""?e.jsxs("div",{className:"relative cursor-default select-none py-2 px-4 text-slate-500",children:['ไม่พบข้อมูล "',h,'"']}):y.map((n,v)=>e.jsx(Ys,{className:({focus:M})=>`relative cursor-pointer select-none py-2.5 pl-10 pr-4 ${M?"bg-slate-100 text-slate-900":"text-slate-900"}`,value:n.value,children:({selected:M,focus:A})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:`block truncate ${M?"font-medium":"font-normal"}`,children:n.label}),n.desc&&e.jsx("span",{className:`text-xs ${A?"text-slate-600":"text-slate-400"}`,children:n.desc})]}),M?e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-slate-900",children:e.jsx(se,{className:"h-4 w-4","aria-hidden":"true"})}):null]})},`${n.value}-${v}`))})})]})})]})},vt={width_m:"",height_m:"",style:"ลอน",opening_style:"center",layer_mode:"main",fabric_variant:"ทึบ",code:"",price_per_m_raw:"",sheer_code:"",sheer_price_per_m:"",rail_color:"",bracket_color:"",notes:"",is_suspended:!1,enable_set_price:!1,set_price_override:0,pleat_hook:"short",eyelet_color:"",chain_position:"right"},Nt={width_m:s=>N(s)<=0?"ระบุความกว้าง":null,height_m:s=>N(s)<=0?"ระบุความสูง":null,price_per_m_raw:(s,t)=>t.layer_mode==="sheer"?null:!t.enable_set_price&&N(s)<=0?"ระบุราคา":null,sheer_price_per_m:(s,t)=>t.layer_mode==="main"?null:!t.enable_set_price&&N(s)<=0?"ระบุราคาโปร่ง":null},wt=({dimensions:s,fabric:t,style:a,summary:r,notes:l,actions:o})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-100 shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-800 font-bold",children:[e.jsx(Ue,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h2",{children:"ขนาดพื้นที่ (เมตร)"})]}),s]}),e.jsx("div",{className:"space-y-4",children:t}),e.jsx("div",{className:"space-y-4",children:a}),e.jsxs("div",{className:"bg-slate-900 p-5 rounded-2xl shadow-xl space-y-4 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"}),e.jsxs("div",{className:"flex items-center gap-2 text-emerald-400 font-bold border-b border-white/10 pb-3",children:[e.jsx(Ve,{className:"w-5 h-5"}),e.jsx("h3",{children:"สรุปรายการคำนวณ"})]}),r]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[l,e.jsx("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-slate-100",children:o})]})]}),yt=({initialData:s,onSubmit:t,onCancel:a})=>{const{formData:r,errors:l,handleChange:o,handleNumberChange:m,validate:c}=X({...vt,...s},Nt),{addToast:x}=O(),d=p=>{p.preventDefault(),c()?t(r):x("error","กรุณากรอกข้อมูลจำเป็นให้ครบถ้วน")};return e.jsx("form",{onSubmit:d,children:e.jsx(wt,{dimensions:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{label:"กว้าง (W)",placeholder:"0.00",value:r.width_m,onChange:p=>m("width_m",p.target.value),isDimension:!0,autoFocus:!0,className:"text-lg font-bold text-indigo-700 bg-indigo-50/30",error:l.width_m}),e.jsx(w,{label:"สูง (H)",placeholder:"0.00",value:r.height_m,onChange:p=>m("height_m",p.target.value),isDimension:!0,className:"text-lg font-bold text-indigo-700 bg-indigo-50/30",error:l.height_m})]}),fabric:e.jsx(_t,{formData:r,errors:l,onChange:o,onNumberChange:m}),style:e.jsx(kt,{formData:r,onChange:o}),summary:e.jsx(Ct,{formData:r,onChange:o,onNumberChange:m}),notes:e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:r.notes||"",onChange:p=>o("notes",p.target.value),className:"bg-white"}),actions:e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,className:"h-12 px-6 text-slate-500",children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"h-12 px-8 text-base shadow-lg shadow-blue-500/20 bg-slate-900 text-white",children:"บันทึก"})]})})})},_t=({formData:s,errors:t,onChange:a,onNumberChange:r})=>{const{addFavorite:l,favorites:o}=k(),{addToast:m}=O(),c=f.useMemo(()=>(o.curtain_main||[]).map(u=>({label:u.code,value:u.code,desc:`${u.price}`,data:u})),[o]),x=f.useMemo(()=>(o.curtain_sheer||[]).map(u=>({label:u.code,value:u.code,desc:`${u.price}`,data:u})),[o]),d=(u,h)=>{if(h==="main"){a("code",u);const g=c.find(j=>j.value.toLowerCase()===u.toLowerCase());g&&g.data?.price&&r("price_per_m_raw",String(g.data.price))}else{a("sheer_code",u);const g=x.find(j=>j.value.toLowerCase()===u.toLowerCase());g&&g.data?.price&&r("sheer_price_per_m",String(g.data.price))}},p=u=>{const h=u==="main"?s.code:s.sheer_code,g=u==="main"?s.price_per_m_raw:s.sheer_price_per_m,j=u==="main"?"curtain_main":"curtain_sheer";if(!h||N(g)<=0)return m("warning","ระบุรหัสและราคาก่อนบันทึก");l(j,{code:h,price:N(g)}),m("success",`บันทึก ${h} แล้ว`)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[13px] font-medium text-slate-500 ml-1",children:"เลือกรูปแบบผ้า"}),e.jsx("div",{className:"flex bg-slate-100 p-1 rounded-xl gap-1",children:[{label:"ทึบ",value:"main",icon:le},{label:"ทึบ & โปร่ง",value:"double",icon:He},{label:"โปร่ง",value:"sheer",icon:ve}].map(u=>e.jsxs("button",{type:"button",onClick:()=>a("layer_mode",u.value),className:b("flex-1 flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-medium transition-all",s.layer_mode===u.value?"bg-white text-slate-900 shadow-sm border border-slate-200/50":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"),children:[e.jsx(u.icon,{className:b("w-4 h-4",s.layer_mode===u.value?"text-indigo-600":"text-slate-400")}),u.label]},u.value))})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-5",children:[(s.layer_mode==="main"||s.layer_mode==="double")&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-slate-500"})," ผ้าทึบ"]}),e.jsx(V,{category:"curtain_main",onSelect:u=>{a("code",u.code),r("price_per_m_raw",String(u.price))}})]}),e.jsx(H,{placeholder:"รหัสผ้าทึบ...",value:s.code||"",onChange:u=>d(u,"main"),options:c}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{placeholder:"ราคา (บาท/เมตรราง)",inputMode:"decimal",value:s.price_per_m_raw||"",onChange:u=>r("price_per_m_raw",u.target.value),error:t.price_per_m_raw}),s.code&&N(s.price_per_m_raw)>0&&e.jsx("button",{type:"button",onClick:()=>p("main"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-300 hover:text-red-500 p-2 z-10",children:e.jsx(ae,{className:"w-5 h-5"})})]})]}),(s.layer_mode==="sheer"||s.layer_mode==="double")&&e.jsxs("div",{className:b("space-y-3",s.layer_mode==="double"&&"pt-5 border-t border-slate-200"),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm font-bold text-indigo-600 flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"})," ผ้าโปร่ง"]}),e.jsx(V,{category:"curtain_sheer",onSelect:u=>{a("sheer_code",u.code),r("sheer_price_per_m",String(u.price))}})]}),e.jsx(H,{placeholder:"รหัสผ้าโปร่ง...",value:s.sheer_code||"",onChange:u=>d(u,"sheer"),options:x}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{placeholder:"ราคาโปร่ง (บาท/เมตรราง)",inputMode:"decimal",value:s.sheer_price_per_m||"",onChange:u=>r("sheer_price_per_m",u.target.value),error:t.sheer_price_per_m}),s.sheer_code&&N(s.sheer_price_per_m)>0&&e.jsx("button",{type:"button",onClick:()=>p("sheer"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-300 hover:text-red-500 p-2 z-10",children:e.jsx(ae,{className:"w-5 h-5"})})]})]})]})]})},kt=({formData:s,onChange:t})=>{const[a,r]=f.useState(!1),l=p=>{t("rail_color",p),s.bracket_color||t("bracket_color",p)},o=!["พับ"].includes(s.style),m=!["แป๊บ"].includes(s.style),c=s.style==="จีบ"||s.style==="หลุยส์",x=s.style==="ตาไก่",d=s.style==="พับ"||s.style==="ลอน";return e.jsxs(e.Fragment,{children:[e.jsx(ls,{label:"รูปแบบม่าน",valueLabel:Te.find(p=>p.value===s.style)?.label||s.style,onClick:()=>r(!0)}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-4",children:[o&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[13px] font-medium text-slate-500",children:"รูปแบบการเปิด"}),e.jsx("div",{className:"flex gap-2",children:[{label:"แยกกลาง",value:"center",icon:oe},{label:"เก็บข้างเดียว",value:"side",icon:ce}].map(p=>e.jsxs("button",{type:"button",onClick:()=>t("opening_style",p.value),className:b("flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm border transition-all",s.opening_style===p.value?"bg-white border-slate-300 text-slate-800 shadow-sm font-medium":"bg-transparent border-transparent text-slate-400 hover:bg-slate-100"),children:[e.jsx(p.icon,{className:"w-4 h-4"})," ",p.label]},p.value))})]}),d&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[13px] font-medium text-slate-500",children:"ฝั่งเก็บโซ่ / ด้ามจูง"}),e.jsx("div",{className:"flex gap-2",children:[{label:"เก็บซ้าย",value:"left"},{label:"เก็บขวา",value:"right"}].map(p=>e.jsx("button",{type:"button",onClick:()=>t("chain_position",p.value),className:b("flex-1 py-2.5 rounded-lg text-sm border transition-all",s.chain_position===p.value?"bg-white border-slate-300 text-slate-800 shadow-sm font-medium":"bg-transparent border-transparent text-slate-400 hover:bg-slate-100"),children:p.label},p.value))})]}),c&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[13px] font-medium text-slate-500",children:"ประเภทตะขอ"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("pleat_hook","short"),className:b("flex items-center gap-2 p-3 rounded-xl border text-left transition-all",s.pleat_hook==="short"?"bg-amber-50 border-amber-200 text-amber-900":"bg-white border-slate-200 text-slate-500 hover:border-slate-300"),children:[e.jsx(Ce,{className:"w-5 h-5 text-amber-500 rotate-180"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold",children:"ตะขอสั้น"}),e.jsx("div",{className:"text-[10px] opacity-70",children:"บังราง (Standard)"})]})]}),e.jsxs("button",{type:"button",onClick:()=>t("pleat_hook","long"),className:b("flex items-center gap-2 p-3 rounded-xl border text-left transition-all",s.pleat_hook==="long"?"bg-amber-50 border-amber-200 text-amber-900":"bg-white border-slate-200 text-slate-500 hover:border-slate-300"),children:[e.jsx(Ce,{className:"w-5 h-5 text-amber-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold",children:"ตะขอยาว"}),e.jsx("div",{className:"text-[10px] opacity-70",children:"โชว์ราง"})]})]})]})]}),x&&e.jsx(w,{label:"สีห่วงตาไก่",placeholder:"เช่น สัก, โอ๊ค, เงิน...",value:s.eyelet_color||"",onChange:p=>t("eyelet_color",p.target.value),prefix:e.jsx(fs,{className:"w-4 h-4 text-slate-400"})}),m&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2 border-t border-slate-200/50",children:[e.jsx(w,{label:s.style==="พับ"?"สีรางบน":"สีราง",placeholder:"ระบุสีราง...",value:s.rail_color||"",onChange:p=>l(p.target.value),prefix:e.jsx(js,{className:"w-4 h-4 text-slate-400"})}),e.jsx(w,{label:"สีขาจับ",placeholder:"Auto...",value:s.bracket_color||"",onChange:p=>t("bracket_color",p.target.value),prefix:e.jsx(ze,{className:"w-4 h-4 text-slate-400"})})]})]}),e.jsx(jt,{isOpen:a,onClose:()=>r(!1),title:"เลือกรูปแบบม่าน",options:Te.map(p=>({...p,icon:He})),value:s.style,onSelect:p=>t("style",p)})]})},Ct=({formData:s,onChange:t,onNumberChange:a})=>{const r=f.useMemo(()=>T.calculateCurtainPrice(s),[s]),l=f.useMemo(()=>{const o=T.fabricYardage(s.style,s.width_m),m=o*1.09361;return{meters:o,yards:Ne(m,1)}},[s.style,s.width_m]);return e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-slate-400",children:"ความกว้างราง (ม.):"}),e.jsxs("span",{className:"font-mono text-white",children:[Ne(r.fabricMeters,2)," ม."]})]}),(s.layer_mode==="main"||s.layer_mode==="double")&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-slate-300 flex items-center gap-2",children:[e.jsx(le,{className:"w-3 h-3 text-slate-500"})," ใช้ผ้าทึบ (หลา):"]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"font-mono font-bold text-emerald-300 text-lg",children:l.yards})})]}),(s.layer_mode==="sheer"||s.layer_mode==="double")&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-slate-300 flex items-center gap-2",children:[e.jsx(ve,{className:"w-3 h-3 text-slate-500"})," ใช้ผ้าโปร่ง (หลา):"]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"font-mono font-bold text-blue-300 text-lg",children:l.yards})})]}),e.jsxs("div",{className:"flex justify-between items-end pt-2 border-t border-white/10 mt-2",children:[e.jsx("span",{className:"text-slate-400 pb-1",children:"ราคารวมโดยประมาณ"}),e.jsx("span",{className:"text-2xl font-bold font-mono text-emerald-400",children:F(r.total)})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{checked:s.enable_set_price||!1,onCheckedChange:o=>t("enable_set_price",o),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"ราคาเหมา (Override)"})]})}),s.enable_set_price&&e.jsx("div",{className:"flex justify-end bg-white/5 p-3 rounded-xl border border-white/10",children:e.jsx("input",{type:"text",inputMode:"decimal",value:s.set_price_override||"",onChange:o=>a("set_price_override",o.target.value),className:"bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1 text-right font-mono font-bold text-lg w-32 focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",placeholder:"0"})})]})]})},St={widths:[""],height_m:"",price_per_roll:0,install_cost_per_roll:0,wallpaper_code:"",notes:"",is_suspended:!1,enable_set_price:!1,set_price_override:0},Mt={height_m:s=>N(s)<=0?"ระบุความสูงผนัง":null,price_per_roll:s=>N(s)<=0?"ระบุราคาต่อม้วน":null},Ft=({initialData:s,onSubmit:t,onCancel:a})=>{const{formData:r,errors:l,isDirty:o,validate:m,handleChange:c,handleNumberChange:x,getFormattedNumber:d,setFormData:p}=X({...St,...s},Mt),u=k(i=>i.favorites),h=f.useMemo(()=>T.calculateWallpaperPrice(r),[r]),g=r.widths?.[0]||"",j=i=>{p(n=>({...n,widths:[i]}))},_=i=>{i.preventDefault(),m()&&t(r)},y=()=>(u.wallpaper||[]).map(n=>({label:n.code,value:n.code,desc:F(n.price),data:n}));return e.jsxs("form",{onSubmit:_,className:"space-y-6 pb-10",children:[e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ue,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ขนาดผนัง (Wall Size)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"กว้าง (ม.)",value:g,onChange:i=>j(i.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",autoFocus:!0,error:!N(g)&&o?"ระบุความกว้าง":void 0})}),e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"สูง (ม.)",value:r.height_m,onChange:i=>x("height_m",i.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",error:l.height_m})})]})]}),e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(We,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ข้อมูลวอลล์เปเปอร์"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute right-2 top-[34px] z-10",children:e.jsx(V,{category:"wallpaper",currentValue:{code:r.wallpaper_code||"",price:N(r.price_per_roll)},onSelect:i=>{p(n=>({...n,wallpaper_code:i.code,price_per_roll:i.price?i.price:n.price_per_roll}))}})}),e.jsx("div",{className:"pr-12",children:e.jsx(H,{label:"รหัสสินค้า / ลาย (Code)",value:r.wallpaper_code||"",onChange:i=>c("wallpaper_code",i),options:y(),placeholder:"ระบุรหัส...",prefix:e.jsx(R,{className:"w-4 h-4 text-slate-400"}),onSelect:i=>{i&&i.price&&x("price_per_roll",String(i.price))}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{label:"ราคา/ม้วน",value:d("price_per_roll"),onChange:i=>x("price_per_roll",i.target.value),inputMode:"decimal",prefix:e.jsx(Q,{className:"w-4 h-4 text-slate-400"}),error:l.price_per_roll}),e.jsx(w,{label:"ค่าแรง/ม้วน",value:d("install_cost_per_roll"),onChange:i=>x("install_cost_per_roll",i.target.value),inputMode:"decimal",prefix:e.jsx(vs,{className:"w-4 h-4 text-slate-400"})})]})]})]}),e.jsxs("section",{className:"bg-slate-900 text-white p-5 rounded-2xl shadow-xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end pb-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs font-medium mb-1",children:"ราคารวมสุทธิ"}),e.jsx("div",{className:"text-3xl font-bold tracking-tight font-mono leading-none",children:F(h.total)})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-sm text-emerald-400 font-medium font-mono",children:["ใช้ ",h.rolls," ม้วน"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"ประมาณการจำนวน"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(L,{checked:r.enable_set_price||!1,onCheckedChange:i=>c("enable_set_price",i),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"กำหนดราคาเอง"})]}),r.enable_set_price&&e.jsx("div",{className:"w-32",children:e.jsx("input",{type:"text",inputMode:"decimal",value:d("set_price_override"),onChange:i=>x("set_price_override",i.target.value),placeholder:"ระบุราคา",className:"w-full bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1.5 text-right font-mono text-sm focus:outline-none focus:border-emerald-500 transition-colors"})})]})]}),e.jsxs("div",{className:"pt-2 space-y-4",children:[e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:r.notes,onChange:i=>c("notes",i.target.value),className:"bg-slate-50 border-transparent focus:bg-white transition-colors"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,className:"h-12 px-6 text-slate-500",children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"h-12 px-8 text-base shadow-lg shadow-blue-500/20",disabled:!o&&!s?.wallpaper_code,children:"บันทึกรายการ"})]})]})]})},Tt={width_m:"",height_m:"",price_sqyd:0,code:"",notes:"",fabric_variant:"Blackout",adjustment_side:"ขวา",is_suspended:!1,enable_set_price:!1,set_price_override:0},At={width_m:s=>N(s)<=0?"ระบุความกว้าง":null,height_m:s=>N(s)<=0?"ระบุความสูง":null,price_sqyd:s=>N(s)<=0?"ระบุราคา":null},Pt=({initialData:s,onSubmit:t,onCancel:a,itemType:r="roller_blind"})=>{const{formData:l,errors:o,isDirty:m,validate:c,handleChange:x,handleNumberChange:d,getFormattedNumber:p,setFormData:u}=X({...Tt,...s},At),h=k(i=>i.favorites),g=f.useMemo(()=>T.calculateAreaPrice(l),[l]),j=i=>{i.preventDefault(),c()&&t(l)},_=[{label:"Sunscreen",value:"Sunscreen",desc:"เห็นวิว"},{label:"Dimout",value:"Dimout",desc:"แสงผ่าน"},{label:"Blackout",value:"Blackout",desc:"ทึบ 100%"}],y=()=>(h[r]||[]).map(n=>({label:n.code,value:n.code,desc:F(n.price),data:n}));return e.jsxs("form",{onSubmit:j,className:"space-y-6 pb-10",children:[e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Xe,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ข้อมูลขนาดและสินค้า"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"กว้าง (ม.)",value:l.width_m,onChange:i=>d("width_m",i.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",autoFocus:!0,error:o.width_m})}),e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"สูง (ม.)",value:l.height_m,onChange:i=>d("height_m",i.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",error:o.height_m})}),e.jsxs("div",{className:"col-span-2 relative",children:[e.jsx("div",{className:"absolute right-2 top-[34px] z-10",children:e.jsx(V,{category:r,currentValue:{code:l.code||"",price:N(l.price_sqyd)},onSelect:i=>{u(n=>({...n,code:i.code,price_sqyd:i.price?i.price:n.price_sqyd}))}})}),e.jsx("div",{className:"pr-12",children:e.jsx(H,{label:"รหัสสินค้า (SKU)",value:l.code||"",onChange:i=>x("code",i),options:y(),placeholder:"ระบุรหัส...",prefix:e.jsx(R,{className:"w-4 h-4 text-slate-400"}),onSelect:i=>{i&&i.price&&d("price_sqyd",String(i.price))}})})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(w,{label:"ราคาต่อหน่วย (บาท/ตร.ล.)",value:p("price_sqyd"),onChange:i=>d("price_sqyd",i.target.value),inputMode:"decimal",placeholder:"0.00",prefix:e.jsx(Q,{className:"w-4 h-4 text-slate-400"}),error:o.price_sqyd})})]})]}),e.jsxs("section",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ชนิดผ้า (Opacity)"}),e.jsx("div",{className:"p-1 bg-slate-100 rounded-xl border border-slate-200",children:e.jsx("div",{className:"flex w-full",children:_.map(i=>{const n=l.fabric_variant===i.value;return e.jsxs("button",{type:"button",onClick:()=>x("fabric_variant",i.value),className:b("flex-1 py-2 px-1 rounded-lg transition-all duration-200 flex flex-col items-center justify-center",n?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700"),children:[e.jsx("span",{className:"text-[13px] font-semibold",children:i.label}),e.jsx("span",{className:b("text-[10px]",n?"text-slate-500":"text-slate-400"),children:i.desc})]},i.value)})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ตำแหน่งโซ่ดึง"}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-2xl border border-slate-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-4 left-4 right-4 h-2 bg-slate-200 -z-10 rounded-full opacity-50"}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ซ้าย"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center px-3 gap-2 bg-white z-0",l.adjustment_side==="ซ้าย"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ซ้าย"?"bg-blue-100":"bg-slate-100"),children:e.jsx(de,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-sm font-semibold",children:"ซ้าย"})]}),e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ขวา"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center justify-end px-3 gap-2 bg-white z-0",l.adjustment_side==="ขวา"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("span",{className:"text-sm font-semibold",children:"ขวา"}),e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ขวา"?"bg-blue-100":"bg-slate-100"),children:e.jsx(xe,{className:"w-3.5 h-3.5"})})]})]})]})]})]}),e.jsxs("section",{className:"bg-slate-900 text-white p-5 rounded-2xl shadow-xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end pb-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs font-medium mb-1",children:"ราคารวมสุทธิ"}),e.jsx("div",{className:"text-3xl font-bold tracking-tight font-mono leading-none",children:F(g.total)})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-sm text-emerald-400 font-medium",children:[g.sqyd.toFixed(2)," ตร.ล."]}),e.jsx("div",{className:"text-xs text-slate-500",children:"พื้นที่คำนวณ"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(L,{checked:l.enable_set_price||!1,onCheckedChange:i=>x("enable_set_price",i),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"กำหนดราคาเอง (Override)"})]}),l.enable_set_price&&e.jsx("div",{className:"w-32",children:e.jsx("input",{type:"text",inputMode:"decimal",value:p("set_price_override"),onChange:i=>d("set_price_override",i.target.value),placeholder:"ระบุราคา",className:"w-full bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1.5 text-right font-mono text-sm focus:outline-none focus:border-emerald-500 transition-colors"})})]})]}),e.jsxs("div",{className:"pt-2 space-y-4",children:[e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:l.notes,onChange:i=>x("notes",i.target.value),className:"bg-slate-50 border-transparent focus:bg-white transition-colors"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,className:"h-12 px-6 text-slate-500",children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"h-12 px-8 text-base shadow-lg shadow-blue-500/20",disabled:!m&&!s?.code,children:"บันทึกรายการ"})]})]})]})},It={width_m:"",height_m:"",price_sqyd:0,code:"",notes:"",fabric_variant:"ไม้",adjustment_side:"ขวา",is_suspended:!1,enable_set_price:!1,set_price_override:0},$t={width_m:s=>N(s)<=0?"ระบุความกว้าง":null,height_m:s=>N(s)<=0?"ระบุความสูง":null,price_sqyd:s=>N(s)<=0?"ระบุราคา":null},Lt=({initialData:s,onSubmit:t,onCancel:a,itemType:r="wooden_blind"})=>{const{formData:l,errors:o,isDirty:m,validate:c,handleChange:x,handleNumberChange:d,getFormattedNumber:p,setFormData:u}=X({...It,...s},$t),h=k(i=>i.favorites),g=f.useMemo(()=>T.calculateAreaPrice(l),[l]),j=i=>{i.preventDefault(),c()&&t(l)},_=[{label:"ไม้ (Wood)",value:"ไม้"},{label:"โฟม (Foam)",value:"โฟม"},{label:"อลูมิเนียม",value:"อลูมิเนียม"}],y=()=>(h[r]||[]).map(n=>({label:n.code,value:n.code,desc:F(n.price),data:n}));return e.jsxs("form",{onSubmit:j,className:"space-y-6 pb-10",children:[e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(le,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ข้อมูลขนาดและสินค้า"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"กว้าง (ม.)",value:l.width_m,onChange:i=>d("width_m",i.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",autoFocus:!0,error:o.width_m})}),e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"สูง (ม.)",value:l.height_m,onChange:i=>d("height_m",i.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",error:o.height_m})}),e.jsxs("div",{className:"col-span-2 relative",children:[e.jsx("div",{className:"absolute right-2 top-[34px] z-10",children:e.jsx(V,{category:r,currentValue:{code:l.code||"",price:N(l.price_sqyd)},onSelect:i=>{u(n=>({...n,code:i.code,price_sqyd:i.price?i.price:n.price_sqyd}))}})}),e.jsx("div",{className:"pr-12",children:e.jsx(H,{label:"รหัสสินค้า (SKU)",value:l.code||"",onChange:i=>x("code",i),options:y(),placeholder:"ระบุรหัส...",prefix:e.jsx(R,{className:"w-4 h-4 text-slate-400"}),onSelect:i=>{i&&i.price&&d("price_sqyd",String(i.price))}})})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(w,{label:"ราคาต่อหน่วย (บาท/ตร.ล.)",value:p("price_sqyd"),onChange:i=>d("price_sqyd",i.target.value),inputMode:"decimal",placeholder:"0.00",prefix:e.jsx(Q,{className:"w-4 h-4 text-slate-400"}),error:o.price_sqyd})})]})]}),e.jsxs("section",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ชนิดวัสดุ"}),e.jsx("div",{className:"p-1 bg-slate-100 rounded-xl border border-slate-200",children:e.jsx("div",{className:"flex w-full",children:_.map(i=>{const n=l.fabric_variant===i.value;return e.jsx("button",{type:"button",onClick:()=>x("fabric_variant",i.value),className:b("flex-1 py-2 text-[14px] rounded-lg transition-all duration-200 font-medium",n?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700"),children:i.label},i.value)})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ตำแหน่งเชือกปรับ"}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-2xl border border-slate-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/2 left-4 right-4 h-0.5 bg-slate-200 -z-10"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ซ้าย"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center px-3 gap-2 bg-white z-0",l.adjustment_side==="ซ้าย"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ซ้าย"?"bg-blue-100":"bg-slate-100"),children:e.jsx(de,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-sm font-semibold",children:"ซ้าย"})]}),e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ขวา"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center justify-end px-3 gap-2 bg-white z-0",l.adjustment_side==="ขวา"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("span",{className:"text-sm font-semibold",children:"ขวา"}),e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ขวา"?"bg-blue-100":"bg-slate-100"),children:e.jsx(xe,{className:"w-3.5 h-3.5"})})]})]})]})]})]}),e.jsxs("section",{className:"bg-slate-900 text-white p-5 rounded-2xl shadow-xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end pb-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs font-medium mb-1",children:"ราคารวมสุทธิ"}),e.jsx("div",{className:"text-3xl font-bold tracking-tight font-mono leading-none",children:F(g.total)})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-sm text-emerald-400 font-medium",children:[g.sqyd.toFixed(2)," ตร.ล."]}),e.jsx("div",{className:"text-xs text-slate-500",children:"พื้นที่คำนวณ"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(L,{checked:l.enable_set_price||!1,onCheckedChange:i=>x("enable_set_price",i),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"กำหนดราคาเอง (Override)"})]}),l.enable_set_price&&e.jsx("div",{className:"w-32",children:e.jsx("input",{type:"text",inputMode:"decimal",value:p("set_price_override"),onChange:i=>d("set_price_override",i.target.value),placeholder:"ระบุราคา",className:"w-full bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1.5 text-right font-mono text-sm focus:outline-none focus:border-emerald-500 transition-colors"})})]})]}),e.jsxs("div",{className:"pt-2 space-y-4",children:[e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:l.notes,onChange:i=>x("notes",i.target.value),className:"bg-slate-50 border-transparent focus:bg-white transition-colors"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,className:"h-12 px-6 text-slate-500",children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"h-12 px-8 text-base shadow-lg shadow-blue-500/20",disabled:!m&&!s?.code,children:"บันทึกรายการ"})]})]})]})},Ot={width_m:"",height_m:"",price_sqyd:0,code:"",notes:"",fabric_variant:"Dimout",opening_style:"เก็บข้างเดียว",adjustment_side:"ขวา",is_suspended:!1,enable_set_price:!1,set_price_override:0},Et={width_m:s=>N(s)<=0?"ระบุความกว้าง":null,height_m:s=>N(s)<=0?"ระบุความสูง":null,price_sqyd:s=>N(s)<=0?"ระบุราคา":null},Rt=({initialData:s,onSubmit:t,onCancel:a,itemType:r="vertical_blind"})=>{const{formData:l,errors:o,isDirty:m,validate:c,handleChange:x,handleNumberChange:d,getFormattedNumber:p,setFormData:u}=X({...Ot,...s},Et),h=k(n=>n.favorites),g=f.useMemo(()=>T.calculateAreaPrice(l),[l]),j=n=>{n.preventDefault(),c()&&t(l)},_=[{label:"Sunscreen",value:"Sunscreen",desc:"เห็นวิว"},{label:"Dimout",value:"Dimout",desc:"แสงผ่าน"},{label:"Blackout",value:"Blackout",desc:"ทึบ 100%"}],y=[{label:"เก็บข้างเดียว",value:"เก็บข้างเดียว",icon:ce},{label:"แยกกลาง",value:"แยกกลาง",icon:oe}],i=()=>(h[r]||[]).map(v=>({label:v.code,value:v.code,desc:F(v.price),data:v}));return e.jsxs("form",{onSubmit:j,className:"space-y-6 pb-10",children:[e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ge,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ข้อมูลขนาดและสินค้า"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"กว้าง (ม.)",value:l.width_m,onChange:n=>d("width_m",n.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",autoFocus:!0,error:o.width_m})}),e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"สูง (ม.)",value:l.height_m,onChange:n=>d("height_m",n.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",error:o.height_m})}),e.jsxs("div",{className:"col-span-2 relative",children:[e.jsx("div",{className:"absolute right-2 top-[34px] z-10",children:e.jsx(V,{category:r,currentValue:{code:l.code||"",price:N(l.price_sqyd)},onSelect:n=>{u(v=>({...v,code:n.code,price_sqyd:n.price?n.price:v.price_sqyd}))}})}),e.jsx("div",{className:"pr-12",children:e.jsx(H,{label:"รหัสสินค้า (SKU)",value:l.code||"",onChange:n=>x("code",n),options:i(),placeholder:"ระบุรหัส...",prefix:e.jsx(R,{className:"w-4 h-4 text-slate-400"}),onSelect:n=>{n&&n.price&&d("price_sqyd",String(n.price))}})})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(w,{label:"ราคาต่อหน่วย (บาท/ตร.ล.)",value:p("price_sqyd"),onChange:n=>d("price_sqyd",n.target.value),inputMode:"decimal",placeholder:"0.00",prefix:e.jsx(Q,{className:"w-4 h-4 text-slate-400"}),error:o.price_sqyd})})]})]}),e.jsxs("section",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ชนิดใบ (Opacity)"}),e.jsx("div",{className:"p-1 bg-slate-100 rounded-xl border border-slate-200",children:e.jsx("div",{className:"flex w-full",children:_.map(n=>{const v=l.fabric_variant===n.value;return e.jsxs("button",{type:"button",onClick:()=>x("fabric_variant",n.value),className:b("flex-1 py-2 px-1 rounded-lg transition-all duration-200 flex flex-col items-center justify-center",v?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700"),children:[e.jsx("span",{className:"text-[13px] font-semibold",children:n.label}),e.jsx("span",{className:b("text-[10px]",v?"text-slate-500":"text-slate-400"),children:n.desc})]},n.value)})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"รูปแบบการเปิด"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:y.map(n=>e.jsxs("button",{type:"button",onClick:()=>x("opening_style",n.value),className:b("h-12 rounded-xl border flex items-center justify-center gap-2 transition-all",l.opening_style===n.value?"border-blue-500 bg-blue-50 text-blue-700 ring-1 ring-blue-500 shadow-sm":"border-slate-200 hover:bg-slate-50 text-slate-600 bg-white"),children:[e.jsx(n.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:n.label})]},n.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ตำแหน่งดึง/ปรับ"}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-2xl border border-slate-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-4 left-4 right-4 h-1 bg-slate-200 -z-10"}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ซ้าย"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center px-3 gap-2 bg-white z-0",l.adjustment_side==="ซ้าย"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ซ้าย"?"bg-blue-100":"bg-slate-100"),children:e.jsx(de,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-sm font-semibold",children:"ซ้าย"})]}),e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ขวา"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center justify-end px-3 gap-2 bg-white z-0",l.adjustment_side==="ขวา"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("span",{className:"text-sm font-semibold",children:"ขวา"}),e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ขวา"?"bg-blue-100":"bg-slate-100"),children:e.jsx(xe,{className:"w-3.5 h-3.5"})})]})]})]})]})]}),e.jsxs("section",{className:"bg-slate-900 text-white p-5 rounded-2xl shadow-xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end pb-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs font-medium mb-1",children:"ราคารวมสุทธิ"}),e.jsx("div",{className:"text-3xl font-bold tracking-tight font-mono leading-none",children:F(g.total)})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-sm text-emerald-400 font-medium",children:[g.sqyd.toFixed(2)," ตร.ล."]}),e.jsx("div",{className:"text-xs text-slate-500",children:"พื้นที่คำนวณ"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(L,{checked:l.enable_set_price||!1,onCheckedChange:n=>x("enable_set_price",n),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"กำหนดราคาเอง"})]}),l.enable_set_price&&e.jsx("div",{className:"w-32",children:e.jsx("input",{type:"text",inputMode:"decimal",value:p("set_price_override"),onChange:n=>d("set_price_override",n.target.value),placeholder:"ระบุราคา",className:"w-full bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1.5 text-right font-mono text-sm focus:outline-none focus:border-emerald-500 transition-colors"})})]})]}),e.jsxs("div",{className:"pt-2 space-y-4",children:[e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:l.notes,onChange:n=>x("notes",n.target.value),className:"bg-slate-50 border-transparent focus:bg-white transition-colors"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,className:"h-12 px-6 text-slate-500",children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"h-12 px-8 text-base shadow-lg shadow-blue-500/20",disabled:!m&&!s?.code,children:"บันทึกรายการ"})]})]})]})},Dt={width_m:"",height_m:"",price_sqyd:0,code:"",notes:"",fabric_variant:"ฉากทึบ",opening_style:"เก็บข้างเดียว",adjustment_side:"ขวา",is_suspended:!1,enable_set_price:!1,set_price_override:0},qt={width_m:s=>N(s)<=0?"ระบุความกว้าง":null,height_m:s=>N(s)<=0?"ระบุความสูง":null,price_sqyd:s=>N(s)<=0?"ระบุราคา":null},zt=({initialData:s,onSubmit:t,onCancel:a,itemType:r="partition"})=>{const{formData:l,errors:o,isDirty:m,validate:c,handleChange:x,handleNumberChange:d,getFormattedNumber:p,setFormData:u}=X({...Dt,...s},qt),h=k(n=>n.favorites),g=f.useMemo(()=>T.calculateAreaPrice(l),[l]),j=n=>{n.preventDefault(),c()&&t(l)},_=[{label:"ฉากทึบ",value:"ฉากทึบ",desc:"Standard"},{label:"ฉากกระจก",value:"ฉากกระจก",desc:"Acrylic"},{label:"ฉากยูโร",value:"ฉากยูโร",desc:"Euro Style"}],y=[{label:"เก็บข้างเดียว",value:"เก็บข้างเดียว",icon:ce},{label:"แยกกลาง",value:"แยกกลาง",icon:oe}],i=()=>(h[r]||[]).map(v=>({label:v.code,value:v.code,desc:F(v.price),data:v}));return e.jsxs("form",{onSubmit:j,className:"space-y-6 pb-10",children:[e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(re,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ข้อมูลขนาดและสินค้า"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"กว้าง (ม.)",value:l.width_m,onChange:n=>d("width_m",n.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",autoFocus:!0,error:o.width_m})}),e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"สูง (ม.)",value:l.height_m,onChange:n=>d("height_m",n.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",error:o.height_m})}),e.jsxs("div",{className:"col-span-2 relative",children:[e.jsx("div",{className:"absolute right-2 top-[34px] z-10",children:e.jsx(V,{category:r,currentValue:{code:l.code||"",price:N(l.price_sqyd)},onSelect:n=>{u(v=>({...v,code:n.code,price_sqyd:n.price?n.price:v.price_sqyd}))}})}),e.jsx("div",{className:"pr-12",children:e.jsx(H,{label:"รหัสสินค้า / รุ่น (SKU)",value:l.code||"",onChange:n=>x("code",n),options:i(),placeholder:"ระบุรุ่น...",prefix:e.jsx(R,{className:"w-4 h-4 text-slate-400"}),onSelect:n=>{n&&n.price&&d("price_sqyd",String(n.price))}})})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(w,{label:"ราคาต่อหน่วย (บาท/ตร.ล.)",value:p("price_sqyd"),onChange:n=>d("price_sqyd",n.target.value),inputMode:"decimal",placeholder:"0.00",prefix:e.jsx(Q,{className:"w-4 h-4 text-slate-400"}),error:o.price_sqyd})})]})]}),e.jsxs("section",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"รุ่นฉากกั้นห้อง"}),e.jsx("div",{className:"p-1 bg-slate-100 rounded-xl border border-slate-200",children:e.jsx("div",{className:"flex w-full",children:_.map(n=>{const v=l.fabric_variant===n.value;return e.jsxs("button",{type:"button",onClick:()=>x("fabric_variant",n.value),className:b("flex-1 py-2 px-1 rounded-lg transition-all duration-200 flex flex-col items-center justify-center",v?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700"),children:[e.jsx("span",{className:"text-[13px] font-semibold",children:n.label}),e.jsx("span",{className:b("text-[10px]",v?"text-slate-500":"text-slate-400"),children:n.desc})]},n.value)})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"รูปแบบการเปิด"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:y.map(n=>e.jsxs("button",{type:"button",onClick:()=>x("opening_style",n.value),className:b("h-12 rounded-xl border flex items-center justify-center gap-2 transition-all",l.opening_style===n.value?"border-blue-500 bg-blue-50 text-blue-700 ring-1 ring-blue-500 shadow-sm":"border-slate-200 hover:bg-slate-50 text-slate-600 bg-white"),children:[e.jsx(n.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:n.label})]},n.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ฝั่งเก็บฉาก (Stacking)"}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-2xl border border-slate-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-4 left-4 right-4 h-1.5 bg-slate-200 -z-10 rounded-full"}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ซ้าย"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center px-3 gap-2 bg-white z-0",l.adjustment_side==="ซ้าย"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ซ้าย"?"bg-blue-100":"bg-slate-100"),children:e.jsx(Se,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-sm font-semibold",children:"เก็บซ้าย"})]}),e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side","ขวา"),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center justify-end px-3 gap-2 bg-white z-0",l.adjustment_side==="ขวา"?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300"),children:[e.jsx("span",{className:"text-sm font-semibold",children:"เก็บขวา"}),e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ขวา"?"bg-blue-100":"bg-slate-100"),children:e.jsx(Se,{className:"w-3.5 h-3.5 rotate-180"})})]})]})]})]})]}),e.jsxs("section",{className:"bg-slate-900 text-white p-5 rounded-2xl shadow-xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end pb-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs font-medium mb-1",children:"ราคารวมสุทธิ"}),e.jsx("div",{className:"text-3xl font-bold tracking-tight font-mono leading-none",children:F(g.total)})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-sm text-emerald-400 font-medium",children:[g.sqyd.toFixed(2)," ตร.ล."]}),e.jsx("div",{className:"text-xs text-slate-500",children:"พื้นที่คำนวณ"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(L,{checked:l.enable_set_price||!1,onCheckedChange:n=>x("enable_set_price",n),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"กำหนดราคาเอง"})]}),l.enable_set_price&&e.jsx("div",{className:"w-32",children:e.jsx("input",{type:"text",inputMode:"decimal",value:p("set_price_override"),onChange:n=>d("set_price_override",n.target.value),placeholder:"ระบุราคา",className:"w-full bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1.5 text-right font-mono text-sm focus:outline-none focus:border-emerald-500 transition-colors"})})]})]}),e.jsxs("div",{className:"pt-2 space-y-4",children:[e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:l.notes,onChange:n=>x("notes",n.target.value),className:"bg-slate-50 border-transparent focus:bg-white transition-colors"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,className:"h-12 px-6 text-slate-500",children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"h-12 px-8 text-base shadow-lg shadow-blue-500/20",disabled:!m&&!s?.code,children:"บันทึกรายการ"})]})]})]})},Bt={width_m:"",height_m:"",price_sqyd:0,code:"",notes:"",fabric_variant:"มาตรฐาน",opening_style:"เก็บข้างเดียว",adjustment_side:"ขวา",is_suspended:!1,enable_set_price:!1,set_price_override:0},Ut={width_m:s=>N(s)<=0?"ระบุความกว้าง":null,height_m:s=>N(s)<=0?"ระบุความสูง":null,price_sqyd:s=>N(s)<=0?"ระบุราคา":null},Vt=({initialData:s,onSubmit:t,onCancel:a,itemType:r="pleated_screen"})=>{const{formData:l,errors:o,isDirty:m,validate:c,handleChange:x,handleNumberChange:d,getFormattedNumber:p,setFormData:u}=X({...Bt,...s},Ut),h=k(n=>n.favorites),g=f.useMemo(()=>T.calculateAreaPrice(l),[l]),j=n=>{n.preventDefault(),c()&&t(l)},_=[{label:"มาตรฐาน",value:"มาตรฐาน",desc:"รางปกติ"},{label:"รางเตี้ย",value:"รางเตี้ย",desc:"Wheelchair"},{label:"Pet Mesh",value:"Pet Mesh",desc:"ทนเล็บสัตว์"}],y=[{label:"เก็บข้างเดียว",value:"เก็บข้างเดียว",icon:ce},{label:"แยกกลาง",value:"แยกกลาง",icon:oe},{label:"อิสระ",value:"อิสระ",icon:Ns}],i=()=>(h[r]||[]).map(v=>({label:v.code,value:v.code,desc:F(v.price),data:v}));return e.jsxs("form",{onSubmit:j,className:"space-y-6 pb-10",children:[e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(re,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ขนาดและสเปคมุ้ง"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"กว้าง (ม.)",value:l.width_m,onChange:n=>d("width_m",n.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",autoFocus:!0,error:o.width_m})}),e.jsx("div",{className:"col-span-1",children:e.jsx(w,{label:"สูง (ม.)",value:l.height_m,onChange:n=>d("height_m",n.target.value),inputMode:"decimal",isDimension:!0,placeholder:"0.00",error:o.height_m})}),e.jsxs("div",{className:"col-span-2 relative",children:[e.jsx("div",{className:"absolute right-2 top-[34px] z-10",children:e.jsx(V,{category:r,currentValue:{code:l.code||"",price:N(l.price_sqyd)},onSelect:n=>{u(v=>({...v,code:n.code,price_sqyd:n.price?n.price:v.price_sqyd}))}})}),e.jsx("div",{className:"pr-12",children:e.jsx(H,{label:"รหัสสีเฟรม / สีผ้ามุ้ง",value:l.code||"",onChange:n=>x("code",n),options:i(),placeholder:"ระบุสี...",prefix:e.jsx(R,{className:"w-4 h-4 text-slate-400"}),onSelect:n=>{n&&n.price&&d("price_sqyd",String(n.price))}})})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(w,{label:"ราคาต่อหน่วย (บาท/ตร.ม.)",value:p("price_sqyd"),onChange:n=>d("price_sqyd",n.target.value),inputMode:"decimal",placeholder:"0.00",prefix:e.jsx(Q,{className:"w-4 h-4 text-slate-400"}),error:o.price_sqyd})})]})]}),e.jsxs("section",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ระบบราง/ประเภทมุ้ง"}),e.jsx("div",{className:"p-1 bg-slate-100 rounded-xl border border-slate-200",children:e.jsx("div",{className:"flex w-full",children:_.map(n=>{const v=l.fabric_variant===n.value;return e.jsxs("button",{type:"button",onClick:()=>x("fabric_variant",n.value),className:b("flex-1 py-2 px-1 rounded-lg transition-all duration-200 flex flex-col items-center justify-center",v?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700"),children:[e.jsx("span",{className:"text-[13px] font-semibold",children:n.label}),e.jsx("span",{className:b("text-[10px]",v?"text-slate-500":"text-slate-400"),children:n.desc})]},n.value)})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"รูปแบบการเปิด"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:y.map(n=>e.jsxs("button",{type:"button",onClick:()=>x("opening_style",n.value),className:b("h-12 rounded-xl border flex flex-col items-center justify-center gap-1 transition-all",l.opening_style===n.value?"border-blue-500 bg-blue-50 text-blue-700 ring-1 ring-blue-500 shadow-sm":"border-slate-200 hover:bg-slate-50 text-slate-600 bg-white"),children:[e.jsx(n.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-[11px] font-medium",children:n.label})]},n.value))})]}),l.opening_style!=="อิสระ"&&e.jsxs("div",{className:"space-y-2 animate-fade-in",children:[e.jsx("label",{className:"text-[15px] font-medium text-slate-700 ml-1",children:"ฝั่งเก็บมุ้ง"}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-2xl border border-slate-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/2 left-4 right-4 h-0.5 bg-slate-200 -z-10"}),e.jsx("div",{className:"flex items-center gap-3",children:["ซ้าย","ขวา"].map(n=>e.jsxs("button",{type:"button",onClick:()=>x("adjustment_side",n),className:b("flex-1 h-12 rounded-xl border-2 transition-all flex items-center px-3 gap-2 bg-white z-0",l.adjustment_side===n?"border-blue-500 text-blue-700 ring-2 ring-blue-100":"border-slate-200 text-slate-400 hover:border-slate-300",n==="ขวา"&&"justify-end"),children:[n==="ซ้าย"&&e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ซ้าย"?"bg-blue-100":"bg-slate-100"),children:e.jsx(de,{className:"w-3.5 h-3.5"})}),e.jsxs("span",{className:"text-sm font-semibold",children:["เก็บ",n]}),n==="ขวา"&&e.jsx("div",{className:b("w-6 h-6 rounded-full flex items-center justify-center",l.adjustment_side==="ขวา"?"bg-blue-100":"bg-slate-100"),children:e.jsx(xe,{className:"w-3.5 h-3.5"})})]},n))})]})]})]}),e.jsxs("section",{className:"bg-slate-900 text-white p-5 rounded-2xl shadow-xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end pb-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs font-medium mb-1",children:"ราคารวมสุทธิ"}),e.jsx("div",{className:"text-3xl font-bold tracking-tight font-mono leading-none",children:F(g.total)})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-sm text-emerald-400 font-medium",children:[g.sqyd.toFixed(2)," ตร.ม."]}),e.jsx("div",{className:"text-xs text-slate-500",children:"พื้นที่คำนวณ"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(L,{checked:l.enable_set_price||!1,onCheckedChange:n=>x("enable_set_price",n),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"กำหนดราคาเอง"})]}),l.enable_set_price&&e.jsx("div",{className:"w-32",children:e.jsx("input",{type:"text",inputMode:"decimal",value:p("set_price_override"),onChange:n=>d("set_price_override",n.target.value),placeholder:"ระบุราคา",className:"w-full bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1.5 text-right font-mono text-sm focus:outline-none focus:border-emerald-500 transition-colors"})})]})]}),e.jsxs("div",{className:"pt-2 space-y-4",children:[e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:l.notes,onChange:n=>x("notes",n.target.value),className:"bg-slate-50 border-transparent focus:bg-white transition-colors"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,className:"h-12 px-6 text-slate-500",children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"h-12 px-8 text-base shadow-lg shadow-blue-500/20",disabled:!m&&!s?.code,children:"บันทึกรายการ"})]})]})]})},Ht={quantity:1,price_per_item:0,description:"",notes:"",is_suspended:!1,enable_set_price:!1,set_price_override:0},Wt={description:s=>s?null:"ระบุรายการ",price_per_item:s=>N(s)<=0?"ระบุราคา":null},Xt=({initialData:s,onSubmit:t,onCancel:a})=>{const{formData:r,errors:l,isDirty:o,validate:m,handleChange:c,handleNumberChange:x,getFormattedNumber:d}=X({...Ht,...s},Wt),p=f.useMemo(()=>T.calculateRemovalPrice(r),[r]),u=h=>{h.preventDefault(),m()&&t(r)};return e.jsxs("form",{onSubmit:u,className:"space-y-6 pb-10",children:[e.jsxs("section",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ye,{className:"w-4 h-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"ข้อมูลรายการรื้อถอน/ค่าแรง"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{label:"รายการ / รายละเอียด",value:r.description,onChange:h=>c("description",h.target.value),placeholder:"เช่น รื้อถอนม่านเก่า, ค่าติดตั้งนั่งร้าน",autoFocus:!0,error:l.description,prefix:e.jsx(R,{className:"w-4 h-4 text-slate-400"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{label:"จำนวน (หน่วย)",value:d("quantity"),onChange:h=>x("quantity",h.target.value),inputMode:"numeric",placeholder:"1",prefix:e.jsx(ws,{className:"w-4 h-4 text-slate-400"})}),e.jsx(w,{label:"ราคาต่อหน่วย",value:d("price_per_item"),onChange:h=>x("price_per_item",h.target.value),inputMode:"decimal",placeholder:"0.00",prefix:e.jsx(Q,{className:"w-4 h-4 text-slate-400"}),error:l.price_per_item})]})]})]}),e.jsxs("section",{className:"bg-slate-900 text-white p-5 rounded-2xl shadow-xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end pb-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-xs font-medium mb-1",children:"ราคารวมสุทธิ"}),e.jsx("div",{className:"text-3xl font-bold tracking-tight font-mono leading-none",children:F(p.total)})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"text-sm text-emerald-400 font-medium",children:[r.quantity," x ",F(N(r.price_per_item))]}),e.jsx("div",{className:"text-xs text-slate-500",children:"สูตรคำนวณ"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(L,{checked:r.enable_set_price||!1,onCheckedChange:h=>c("enable_set_price",h),className:"data-[state=checked]:bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"เหมาจ่าย (Override)"})]}),r.enable_set_price&&e.jsx("div",{className:"w-32",children:e.jsx("input",{type:"text",inputMode:"decimal",value:d("set_price_override"),onChange:h=>x("set_price_override",h.target.value),placeholder:"ราคาเหมา",className:"w-full bg-slate-800 text-white border border-slate-600 rounded-lg px-3 py-1.5 text-right font-mono text-sm focus:outline-none focus:border-emerald-500 transition-colors"})})]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsx(w,{label:"หมายเหตุเพิ่มเติม",value:r.notes,onChange:h=>c("notes",h.target.value),className:"bg-slate-50 border-transparent focus:bg-white transition-colors"}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-slate-100/50",children:[e.jsx(C,{variant:"ghost",type:"button",onClick:a,children:"ยกเลิก"}),e.jsx(C,{type:"submit",className:"min-w-[120px]",disabled:!o&&!s?.description,children:"บันทึก"})]})]})]})},Gt=[{id:"curtain",icon:ys},{id:"wooden_blind",icon:_s},{id:"roller_blind",icon:Xe},{id:"vertical_blind",icon:Ge},{id:"partition",icon:re},{id:"pleated_screen",icon:re},{id:"wallpaper",icon:We},{id:"removal",icon:ye}],Kt=({isOpen:s,onClose:t,mode:a,itemType:r,initialData:l,onSubmit:o})=>{const m=j=>j==="set"?"curtain":j,[c,x]=f.useState(m(r)),[d,p]=f.useState(!0);f.useEffect(()=>{if(s){if(a==="add")p(!0),x(m(r));else if(a==="edit"&&l){p(!1);const j=l.type||r;x(m(j))}}},[s]);const u=j=>{x(j),p(!1)},h=(j,_=!0)=>{const y={...j,type:c};o(y,_)},g=U[c];return e.jsx(E,{isOpen:s,onClose:t,title:d?"เลือกประเภทสินค้า":g?.name||"รายละเอียดสินค้า",maxWidth:"lg",children:d?e.jsx("div",{className:"pb-safe-area",children:e.jsx("div",{className:"grid grid-cols-2 gap-3 p-1",children:Gt.map(j=>{const _=U[j.id],y=_?.color||"bg-slate-100",i=_?.name||j.id,n=y.replace("bg-",""),v=`bg-${n}-50`,M=`text-${n}-600`;return e.jsxs("button",{onClick:()=>u(j.id),className:b("group relative flex items-center p-3 rounded-xl border transition-all duration-200","bg-white border-slate-100 shadow-sm","hover:border-blue-200 hover:bg-slate-50","active:scale-[0.98]"),children:[e.jsx("div",{className:b("w-10 h-10 rounded-lg flex items-center justify-center mr-3 shrink-0",v),children:e.jsx(j.icon,{className:b("w-5 h-5",M),strokeWidth:2})}),e.jsx("span",{className:"text-[14px] font-semibold text-slate-700",children:i})]},j.id)})})}):e.jsxs("div",{className:"relative",children:[a==="add"&&e.jsxs("button",{onClick:()=>p(!0),className:"absolute -top-[52px] right-0 text-xs font-medium bg-white border border-slate-200 text-slate-600 px-3 py-1.5 rounded-full flex items-center gap-1 hover:bg-slate-50 transition-colors shadow-sm",children:[e.jsx(ks,{className:"w-3 h-3"})," เปลี่ยนประเภท"]}),c==="curtain"&&e.jsx(yt,{initialData:l,onSubmit:h,onCancel:t}),c==="wallpaper"&&e.jsx(Ft,{initialData:l,onSubmit:h,onCancel:t}),c==="roller_blind"&&e.jsx(Pt,{initialData:l,onSubmit:h,onCancel:t}),(c==="wooden_blind"||c==="aluminum_blind")&&e.jsx(Lt,{itemType:c,initialData:l,onSubmit:h,onCancel:t}),c==="vertical_blind"&&e.jsx(Rt,{initialData:l,onSubmit:h,onCancel:t}),c==="partition"&&e.jsx(zt,{initialData:l,onSubmit:h,onCancel:t}),c==="pleated_screen"&&e.jsx(Vt,{initialData:l,onSubmit:h,onCancel:t}),c==="removal"&&e.jsx(Xt,{initialData:l,onSubmit:h,onCancel:t})]})})},Qt=({isOpen:s,onClose:t})=>{const a=k(o=>o.customer),r=k(o=>o.setCustomer),l=(o,m)=>{r({[o]:m})};return e.jsx(E,{isOpen:s,onClose:t,title:"ข้อมูลลูกค้า (Customer Info)",children:e.jsxs("div",{className:"space-y-6 pb-safe-area",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{prefix:e.jsx(Cs,{className:"w-4 h-4 text-slate-400"}),label:"ชื่อลูกค้า / บริษัท (Name)",placeholder:"ระบุชื่อลูกค้า...",value:a.name,onChange:o=>l("name",o.target.value),autoFocus:!0}),e.jsx(w,{prefix:e.jsx(Ss,{className:"w-4 h-4 text-slate-400"}),label:"เบอร์โทร (Phone)",placeholder:"08X-XXX-XXXX",value:a.phone,onChange:o=>l("phone",o.target.value),inputMode:"tel"}),e.jsx(w,{prefix:e.jsx(me,{className:"w-4 h-4 text-slate-400"}),label:"เลขผู้เสียภาษี (Tax ID)",placeholder:"ถ้ามี...",value:a.taxId||"",onChange:o=>l("taxId",o.target.value)}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[15px] font-medium text-slate-700 ml-1 flex items-center gap-2",children:[e.jsx(Ms,{className:"w-4 h-4"})," ที่อยู่เปิดบิล (Billing Address)"]}),e.jsx("textarea",{className:"w-full p-3 rounded-xl border border-slate-200 bg-white text-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 min-h-[80px] resize-none text-[16px]",placeholder:"บ้านเลขที่, ถนน, แขวง/ตำบล...",value:a.address,onChange:o=>l("address",o.target.value)})]})]}),e.jsx("hr",{className:"border-slate-100"}),e.jsxs("div",{className:"space-y-4 bg-slate-50 p-4 rounded-2xl border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4"})," สถานที่ติดตั้ง (Site Location)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs text-slate-500 cursor-pointer",htmlFor:"show-site",children:"แสดงในเอกสาร"}),e.jsx(L,{id:"show-site",checked:a.showInstallationAddress!==!1,onCheckedChange:o=>l("showInstallationAddress",o)})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"ใช้ที่อยู่เดียวกับที่อยู่เปิดบิล"}),e.jsx(L,{checked:a.useSameAddress!==!1,onCheckedChange:o=>l("useSameAddress",o)})]}),a.useSameAddress===!1&&e.jsx("div",{className:"animate-fade-in",children:e.jsx("textarea",{className:"w-full p-3 rounded-xl border border-slate-200 bg-white text-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 min-h-[80px] resize-none text-[16px]",placeholder:"ระบุสถานที่ติดตั้ง...",value:a.installationAddress||"",onChange:o=>l("installationAddress",o.target.value)})}),a.useSameAddress!==!1&&e.jsx("div",{className:"p-3 border border-dashed border-slate-300 rounded-xl text-center text-slate-400 text-xs",children:"ใช้ที่อยู่เดียวกับด้านบน"})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx(C,{onClick:t,className:"w-full sm:w-auto bg-slate-900 text-white min-w-[120px]",children:"เสร็จสิ้น"})})]})})},G=s=>s.toLocaleString("th-TH",{minimumFractionDigits:2,maximumFractionDigits:2}),Yt=()=>{const s=new Date,t=s.getFullYear().toString().slice(-2),a=(s.getMonth()+1).toString().padStart(2,"0"),r=Math.floor(Math.random()*1e3).toString().padStart(4,"0");return`QT-${t}${a}-${r}`},Jt=s=>{const t=[];return s.forEach(a=>{if(a.is_suspended)return;const r=T.getItemPrice(a),{id:l,...o}=a,m=JSON.stringify(o),c=t.find(x=>{const{id:d,...p}=x.item;return JSON.stringify(p)===m});c?(c.count+=1,c.totalPrice+=r):t.push({item:a,count:1,unitPrice:r,totalPrice:r})}),t},Zt=K.forwardRef(({docType:s},t)=>{const{shopConfig:a,customer:r,rooms:l}=k(i=>i),{grandTotal:o,discountAmount:m,vatAmount:c,finalTotal:x}=ue(),d=s==="delivery",p=!d,[u]=f.useState(Yt),h={quotation:"ใบเสนอราคา (QUOTATION)",delivery:"ใบส่งของ / ใบส่งมอบงาน (DELIVERY NOTE)",receipt:"ใบเสร็จรับเงิน (RECEIPT)"},g=`
      @page { size: A4; margin: 10mm 15mm; }
      @media print {
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        html, body { height: auto !important; overflow: visible !important; }
        #root { display: block !important; }
        thead { display: table-header-group; }
        tfoot { display: table-footer-group; }
        tr { break-inside: avoid; page-break-inside: avoid; }
        .room-header { break-after: avoid; page-break-after: avoid; }
        .no-print { display: none !important; }
      }
    `,j=r.showInstallationAddress!==!1,_=r.useSameAddress!==!1,y=_?"(สถานที่ติดตั้งเดียวกับที่อยู่ลูกค้า)":r.installationAddress||"-";return e.jsxs("div",{ref:t,className:"bg-white text-slate-900 font-sans leading-normal text-[12px]",children:[e.jsx("style",{children:g}),e.jsxs("div",{className:"w-[210mm] min-h-[297mm] px-[10mm] py-[10mm] mx-auto flex flex-col bg-white",children:[e.jsxs("header",{className:"flex justify-between items-start border-b-2 border-slate-800 pb-4 mb-4",children:[e.jsxs("div",{className:"flex gap-4 items-start",children:[a.logoUrl?e.jsx("img",{src:a.logoUrl,alt:"Logo",className:"w-[80px] h-[80px] object-contain border border-slate-100 rounded"}):e.jsx("div",{className:"w-[80px] h-[80px] bg-slate-100 flex items-center justify-center text-slate-300 font-bold rounded",children:"LOGO"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:a.name||"ชื่อร้านค้า"}),e.jsx("div",{className:"text-slate-600 whitespace-pre-line mt-1 leading-tight",children:a.address}),e.jsxs("div",{className:"text-slate-600 mt-2",children:[e.jsx("span",{className:"font-bold",children:"โทร:"})," ",a.phone,a.taxId&&e.jsxs("span",{className:"ml-3",children:[e.jsx("span",{className:"font-bold",children:"เลขผู้เสียภาษี:"})," ",a.taxId]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:b("inline-block px-4 py-1.5 text-sm font-bold rounded border mb-3",d?"bg-slate-100 border-slate-300":"bg-slate-900 text-white border-slate-900"),children:h[s]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx("span",{className:"font-bold text-slate-500",children:"เลขที่:"}),e.jsx("span",{className:"font-mono font-bold text-base",children:u})]}),e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx("span",{className:"font-bold text-slate-500",children:"วันที่:"}),e.jsx("div",{className:"w-[100px] border-b border-slate-400 h-5"})]})]})]})]}),e.jsxs("section",{className:"mb-5 border border-slate-300 rounded-xl flex overflow-hidden bg-white",children:[e.jsxs("div",{className:b("p-4",j?"flex-[1.2]":"flex-1"),children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("h3",{className:"font-bold text-slate-900 text-xs uppercase tracking-wider bg-slate-100 px-2 py-0.5 rounded",children:"ข้อมูลลูกค้า (Customer)"})}),e.jsxs("div",{className:"space-y-1.5 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-[80px_1fr] gap-2",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"ชื่อลูกค้า:"}),e.jsx("span",{className:"font-bold text-slate-900 text-[13px]",children:r.name||"-"})]}),e.jsxs("div",{className:"grid grid-cols-[80px_1fr] gap-2",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"ที่อยู่:"}),e.jsx("span",{className:"text-slate-800 leading-snug",children:r.address||"-"})]}),e.jsxs("div",{className:"grid grid-cols-[80px_1fr] gap-2",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"เบอร์โทร:"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("span",{className:"font-mono text-slate-800",children:r.phone||"-"}),r.taxId&&e.jsxs("span",{className:"text-slate-600",children:[e.jsx("span",{className:"font-medium text-slate-500 mr-1",children:"Tax ID:"}),r.taxId]})]})]})]})]}),j&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px bg-slate-200 my-3"}),e.jsxs("div",{className:"flex-1 p-4 bg-slate-50/30",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("h3",{className:"font-bold text-slate-900 text-xs uppercase tracking-wider bg-slate-100 px-2 py-0.5 rounded",children:"สถานที่ติดตั้ง (Site Location)"})}),e.jsx("div",{className:b("text-sm leading-relaxed",_?"text-slate-400 italic":"text-slate-700"),children:y})]})]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("table",{className:"w-full border border-slate-300 border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100 text-slate-900 text-xs border-b border-slate-300",children:[e.jsx("th",{className:"py-2 w-[45px] text-center font-bold border-r border-slate-300",children:"ลำดับ"}),e.jsx("th",{className:"py-2 px-2 text-left font-bold border-r border-slate-300",children:"รายการสินค้า (Description)"}),e.jsx("th",{className:"py-2 px-2 w-[60px] text-center font-bold border-r border-slate-300",children:"จำนวน"}),p?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"py-2 px-2 w-[110px] text-right font-bold border-r border-slate-300",children:"ราคา/หน่วย"}),e.jsx("th",{className:"py-2 pr-2 w-[120px] text-right font-bold",children:"จำนวนเงิน"})]}):e.jsx("th",{className:"py-2 px-2 w-[150px] text-center font-bold",children:"หมายเหตุ"})]})}),l.map((i,n)=>{if(i.items.length===0)return null;const v=Jt(i.items);return e.jsxs("tbody",{className:"border-b border-slate-300 last:border-0",children:[e.jsxs("tr",{className:"bg-slate-50/80 room-header border-b border-slate-300",children:[e.jsx("td",{className:"py-1.5 px-1 text-center font-bold text-slate-600 border-r border-slate-300 bg-slate-100",children:n+1}),e.jsxs("td",{colSpan:p?4:3,className:"py-1.5 px-2 font-bold text-slate-900",children:["🏠 ",i.name]})]}),v.map((M,A)=>{const{item:P,count:D,unitPrice:J,totalPrice:be}=M,S=U[P.type];let q=S?S.name:"รายการ",Z="",Y="";if(P.type==="curtain"){const $=P;q="ผ้าม่าน",Z=`${$.style||"-"} (${$.fabric_variant||"-"}) ${$.code?`รหัส: ${$.code}`:""}`,Y=`${I($.width_m)} × ${I($.height_m)} ม.`}else if(P.type==="wallpaper"){const $=P;q="วอลล์เปเปอร์",Z=$.wallpaper_code?`Code: ${$.wallpaper_code}`:"",Y="-"}else if(P.type==="removal"){const $=P;q="งานรื้อถอน/อื่นๆ",Z=$.description||"",Y="-"}else if("width_m"in P&&"height_m"in P){const $=P;Z=$.code?`รหัส: ${$.code}`:"",Y=`${I($.width_m)} × ${I($.height_m)} ม.`}return e.jsxs("tr",{className:"border-b border-slate-200 text-xs even:bg-slate-50 hover:bg-slate-100/50",children:[e.jsxs("td",{className:"py-2.5 px-1 text-center text-slate-500 align-top border-r border-slate-300",children:[n+1,".",A+1]}),e.jsxs("td",{className:"py-2.5 px-2 align-top border-r border-slate-300",children:[e.jsx("div",{className:"font-bold text-slate-800 text-[13px]",children:q}),e.jsx("div",{className:"text-slate-600",children:Z}),Y!=="-"&&e.jsx("div",{className:"text-slate-500 font-mono mt-0.5 text-[11px]",children:Y}),P.notes&&e.jsxs("div",{className:"text-[10px] text-red-500 mt-0.5",children:["* ",P.notes]})]}),e.jsx("td",{className:"py-2.5 px-2 text-center align-top font-mono text-slate-900 border-r border-slate-300 font-bold text-[13px]",children:D}),p?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"py-2.5 px-2 text-right align-top font-mono text-slate-700 border-r border-slate-300 text-[13px]",children:G(J)}),e.jsx("td",{className:"py-2.5 pr-2 text-right align-top font-mono font-bold text-slate-900 text-[13px]",children:G(be)})]}):e.jsx("td",{className:"py-2.5 px-2 text-center align-top text-slate-400",children:"-"})]},A)})]},i.id)})]})}),e.jsxs("div",{className:"mt-6 break-inside-avoid page-break-inside-avoid",children:[e.jsxs("div",{className:"flex items-start border-t-2 border-slate-800 pt-4 gap-6",children:[e.jsxs("div",{className:"flex-1",children:[p&&e.jsxs("div",{className:"bg-slate-100 p-2 rounded mb-3 text-center border border-slate-200",children:[e.jsx("span",{className:"text-[10px] text-slate-500 block uppercase tracking-wider mb-1",children:"จำนวนเงินตัวอักษร"}),e.jsx("span",{className:"font-bold text-slate-800 text-sm",children:ct(x)})]}),e.jsxs("div",{className:"text-[10px] text-slate-600 space-y-1",children:[e.jsx("div",{className:"font-bold text-slate-800 text-xs",children:"เงื่อนไข / หมายเหตุ:"}),e.jsxs("ul",{className:"list-disc list-inside pl-1",children:[a.pdf?.priceValidity&&e.jsxs("li",{children:["ยืนยันราคาภายใน ",a.pdf.priceValidity]}),a.pdf?.paymentTerms&&e.jsx("li",{children:a.pdf.paymentTerms}),a.pdf?.notes?.map((i,n)=>i.trim()&&e.jsx("li",{children:i},n))]}),a.bankAccount?.isEnabled!==!1&&a.bankAccount?.accountNumber&&e.jsxs("div",{className:"mt-2 p-2 border border-slate-300 rounded bg-white inline-block min-w-[250px]",children:[e.jsx("div",{className:"font-bold text-slate-900 mb-1 border-b border-slate-200 pb-1",children:"ชำระเงินผ่านบัญชี"}),e.jsxs("div",{className:"grid grid-cols-[60px_1fr] gap-1",children:[e.jsx("span",{className:"text-slate-500",children:"ธนาคาร:"}),e.jsx("span",{children:a.bankAccount.bankName}),e.jsx("span",{className:"text-slate-500",children:"ชื่อบัญชี:"}),e.jsx("span",{children:a.bankAccount.accountName}),e.jsx("span",{className:"text-slate-500",children:"เลขที่:"}),e.jsx("span",{className:"font-mono font-bold text-slate-900 text-[13px]",children:a.bankAccount.accountNumber}),a.bankAccount.branch&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-slate-500",children:"สาขา:"}),e.jsx("span",{children:a.bankAccount.branch})]})]})]})]})]}),p&&e.jsxs("div",{className:"w-[260px] text-sm",children:[e.jsxs("div",{className:"space-y-1 border-b border-slate-300 pb-2 mb-2",children:[e.jsxs("div",{className:"flex justify-between text-slate-600",children:[e.jsx("span",{children:"รวมเป็นเงิน"}),e.jsx("span",{className:"font-mono font-medium text-[13px]",children:G(o)})]}),m>0&&e.jsxs("div",{className:"flex justify-between text-green-700",children:[e.jsx("span",{children:"ส่วนลด"}),e.jsxs("span",{className:"font-mono font-medium text-[13px]",children:["-",G(m)]})]}),a.baseVatRate>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-slate-600 text-xs",children:[e.jsx("span",{children:"หลังหักส่วนลด"}),e.jsx("span",{className:"font-mono",children:G(o-m)})]}),e.jsxs("div",{className:"flex justify-between text-slate-600",children:[e.jsxs("span",{children:["VAT ",a.baseVatRate,"%"]}),e.jsx("span",{className:"font-mono",children:G(c)})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-slate-900 text-white p-3 rounded shadow-sm",children:[e.jsx("span",{className:"font-bold",children:"ยอดสุทธิ"}),e.jsx("span",{className:"font-bold text-xl font-mono",children:G(x)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 mt-10",children:[e.jsxs("div",{className:"border border-slate-300 rounded-xl p-4 flex flex-col items-center justify-between min-h-[180px]",children:[e.jsx("div",{className:"text-xs font-bold text-slate-900 uppercase tracking-wide",children:"ผู้เสนอราคา / ผู้รับเงิน"}),e.jsxs("div",{className:"w-full flex flex-col items-center mt-auto",children:[e.jsx("div",{className:"border-b border-slate-900 w-[160px] h-8 mb-6"}),e.jsxs("div",{className:"flex gap-1 text-slate-500 text-[11px]",children:["(",e.jsx("div",{className:"w-[140px] text-center relative top-[2px]",children:".................................................."}),")"]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-[11px] text-slate-500 mt-4",children:[e.jsx("span",{children:"วันที่:"}),e.jsx("div",{className:"w-8 border-b border-slate-400 h-4"}),e.jsx("span",{children:"/"}),e.jsx("div",{className:"w-8 border-b border-slate-400 h-4"}),e.jsx("span",{children:"/"}),e.jsx("div",{className:"w-10 border-b border-slate-400 h-4"})]})]}),e.jsxs("div",{className:"border border-slate-300 rounded-xl p-4 flex flex-col items-center justify-between min-h-[180px]",children:[e.jsx("div",{className:"text-xs font-bold text-slate-900 uppercase tracking-wide",children:"ผู้อนุมัติสั่งซื้อ / ผู้รับสินค้า"}),e.jsxs("div",{className:"w-full flex flex-col items-center mt-auto",children:[e.jsx("div",{className:"border-b border-slate-900 w-[160px] h-8 mb-6"}),e.jsxs("div",{className:"flex gap-1 text-slate-500 text-[11px]",children:["(",e.jsx("div",{className:"w-[140px] text-center relative top-[2px]",children:".................................................."}),")"]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-[11px] text-slate-500 mt-4",children:[e.jsx("span",{children:"วันที่:"}),e.jsx("div",{className:"w-8 border-b border-slate-400 h-4"}),e.jsx("span",{children:"/"}),e.jsx("div",{className:"w-8 border-b border-slate-400 h-4"}),e.jsx("span",{children:"/"}),e.jsx("div",{className:"w-10 border-b border-slate-400 h-4"})]})]})]})]})]})]})}),ea=({isOpen:s,onClose:t})=>{const a=f.useRef(null),[r,l]=f.useState("quotation"),[o,m]=f.useState(!1),c=es.useReactToPrint({contentRef:a,documentTitle:`Marnthara_${r}_${new Date().toISOString().split("T")[0]}`,onBeforeGetContent:()=>new Promise(d=>{m(!0),setTimeout(d,300)}),onAfterPrint:()=>{m(!1)}}),x=[{id:"quotation",label:"1. ใบเสนอราคา",icon:me},{id:"delivery",label:"2. ใบส่งมอบงาน",icon:Ke},{id:"receipt",label:"3. ใบเสร็จรับเงิน",icon:Fs}];return e.jsx(W,{show:s,as:K.Fragment,children:e.jsxs(he,{onClose:t,className:"relative z-50",children:[e.jsx(B,{as:K.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 sm:p-6",children:e.jsx(B,{as:K.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95 translate-y-4",enterTo:"opacity-100 scale-100 translate-y-0",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100 translate-y-0",leaveTo:"opacity-0 scale-95 translate-y-4",children:e.jsxs(pe,{className:"w-full max-w-6xl h-[90vh] bg-slate-100 rounded-2xl shadow-2xl flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 p-4 flex flex-col sm:flex-row items-center justify-between gap-4 shrink-0 z-10",children:[e.jsx("div",{className:"flex p-1 bg-slate-100 rounded-xl w-full sm:w-auto overflow-x-auto",children:x.map(d=>{const p=d.icon,u=r===d.id;return e.jsxs("button",{onClick:()=>l(d.id),className:b("flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap",u?"bg-white text-slate-900 shadow-sm font-semibold":"text-slate-500 hover:text-slate-700"),children:[e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:d.label})]},d.id)})}),e.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[e.jsx(C,{variant:"ghost",onClick:t,className:"flex-1 sm:flex-none",children:"ปิด"}),e.jsxs(C,{onClick:()=>c(),className:"flex-1 sm:flex-none bg-slate-900 text-white hover:bg-slate-800 shadow-lg",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"})," พิมพ์เอกสาร"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-500/10 p-4 sm:p-8 flex justify-center items-start",children:e.jsx("div",{className:b("shadow-2xl origin-top transition-all duration-300 bg-white",o?"scale-100":"scale-[0.6] sm:scale-[0.75] lg:scale-[0.85]"),children:e.jsx(Zt,{ref:a,docType:r})})})]})})})]})})},sa=({isOpen:s,onClose:t})=>{const a=k(i=>i.shopConfig),r=k(i=>i.updateShopConfig),l=k(i=>i.resetAll),{confirm:o}=ke(),m=O(i=>i.addToast),[c,x]=f.useState(a),[d,p]=f.useState("general"),u=()=>{r(c),m("success","บันทึกข้อมูลร้านค้าเรียบร้อย"),t()},h=async()=>{await o({title:"ล้างข้อมูลทั้งหมด?",description:"การกระทำนี้จะลบข้อมูลลูกค้า รายการสินค้า และการตั้งค่าทั้งหมด ไม่สามารถกู้คืนได้",confirmLabel:"ล้างข้อมูล",variant:"destructive"})&&(l(),m("success","รีเซ็ตระบบเรียบร้อย"),t())},g=(i,n)=>{x(v=>({...v,[i]:n}))},j=(i,n)=>{x(v=>({...v,pdf:{...v.pdf,[i]:n}}))},_=i=>{const n=i.split(`
`);x(v=>({...v,pdf:{...v.pdf,notes:n}}))},y=(i,n)=>{x(v=>({...v,bankAccount:{...v.bankAccount,[i]:n}}))};return e.jsxs(E,{isOpen:s,onClose:t,title:"ตั้งค่าร้านค้า (Shop Settings)",children:[e.jsxs("div",{className:"flex p-1 bg-slate-100 rounded-xl mb-6",children:[e.jsxs("button",{onClick:()=>p("general"),className:b("flex-1 py-2 text-sm font-medium rounded-lg transition-all flex items-center justify-center gap-2",d==="general"?"bg-white shadow-sm text-slate-900":"text-slate-500 hover:text-slate-700"),children:[e.jsx(As,{className:"w-4 h-4"})," ข้อมูลทั่วไป"]}),e.jsxs("button",{onClick:()=>p("payment"),className:b("flex-1 py-2 text-sm font-medium rounded-lg transition-all flex items-center justify-center gap-2",d==="payment"?"bg-white shadow-sm text-slate-900":"text-slate-500 hover:text-slate-700"),children:[e.jsx(Ps,{className:"w-4 h-4"})," การชำระเงิน"]})]}),e.jsx("div",{className:"space-y-4 pb-safe-area",children:d==="general"?e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{label:"ชื่อร้านค้า",value:c.name,onChange:i=>g("name",i.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{label:"เบอร์โทรศัพท์",value:c.phone,onChange:i=>g("phone",i.target.value)}),e.jsx(w,{label:"เลขผู้เสียภาษี",value:c.taxId,onChange:i=>g("taxId",i.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-1 block",children:"ที่อยู่ร้านค้า"}),e.jsx("textarea",{className:"w-full p-3 border border-slate-200 rounded-xl text-[16px] focus:outline-none focus:ring-2 focus:ring-slate-900 resize-none h-20",value:c.address,onChange:i=>g("address",i.target.value)})]}),e.jsx(w,{label:"Logo URL",placeholder:"https://...",value:c.logoUrl,onChange:i=>g("logoUrl",i.target.value)})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(me,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-bold text-slate-900",children:"ข้อความท้ายเอกสาร (Document Footer)"})]}),e.jsxs("div",{className:"space-y-4 bg-slate-50 p-4 rounded-2xl border border-slate-200",children:[e.jsx(w,{label:"1. ระยะเวลายืนยันราคา",placeholder:"เช่น 30 วัน",value:c.pdf?.priceValidity||"",onChange:i=>j("priceValidity",i.target.value)}),e.jsx(w,{label:"2. เงื่อนไขการชำระเงิน",placeholder:"เช่น มัดจำ 50%...",value:c.pdf?.paymentTerms||"",onChange:i=>j("paymentTerms",i.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-1 block",children:"3. หมายเหตุเพิ่มเติม (ขึ้นบรรทัดใหม่เพื่อเพิ่มข้อ)"}),e.jsx("textarea",{className:"w-full p-3 border border-slate-200 rounded-xl text-[16px] focus:outline-none focus:ring-2 focus:ring-slate-900 resize-none h-24",placeholder:"เช่น ราคานี้รวมค่าติดตั้งแล้ว...",value:c.pdf?.notes?.join(`
`)||"",onChange:i=>_(i.target.value)})]})]})]})]}):e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-200",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-900",children:"แสดงข้อมูลบัญชีธนาคาร"}),e.jsx("span",{className:"text-xs text-slate-500",children:"แสดงท้ายเอกสารใบเสนอราคา"})]}),e.jsx(L,{checked:c.bankAccount?.isEnabled!==!1,onCheckedChange:i=>y("isEnabled",i)})]}),e.jsxs("div",{className:b("space-y-4 transition-opacity",c.bankAccount?.isEnabled===!1&&"opacity-50 pointer-events-none"),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{label:"ชื่อธนาคาร",placeholder:"เช่น กสิกรไทย, SCB",value:c.bankAccount?.bankName||"",onChange:i=>y("bankName",i.target.value)}),e.jsx(w,{label:"สาขา (ถ้ามี)",value:c.bankAccount?.branch||"",onChange:i=>y("branch",i.target.value)})]}),e.jsx(w,{label:"ชื่อบัญชี",placeholder:"ระบุชื่อบัญชี...",value:c.bankAccount?.accountName||"",onChange:i=>y("accountName",i.target.value)}),e.jsx(w,{label:"เลขที่บัญชี",placeholder:"XXX-X-XXXXX-X",className:"font-mono",value:c.bankAccount?.accountNumber||"",onChange:i=>y("accountNumber",i.target.value)})]})]})}),e.jsxs("div",{className:"flex justify-between mt-4 pt-4 border-t border-slate-100",children:[e.jsxs(C,{variant:"ghost",onClick:h,className:"text-red-500 hover:bg-red-50 hover:text-red-600",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"ล้างระบบ"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{variant:"ghost",onClick:t,children:"ยกเลิก"}),e.jsxs(C,{onClick:u,className:"bg-slate-900 text-white w-32",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"})," บันทึก"]})]})]})]})},ta=({isOpen:s,onClose:t})=>{const a=k(h=>h.favorites),r=k(h=>h.removeFavorite),[l,o]=f.useState("all"),[m,c]=f.useState(!1),x=Object.keys(a).filter(h=>a[h]&&a[h].length>0),d=l==="all"?x:[l],p={fabric:"ผ้าทึบ",sheer:"ผ้าโปร่ง",wallpaper:"วอลล์เปเปอร์",set:"ผ้าม่าน",wooden_blind:"มู่ลี่ไม้",roller_blind:"ม่านม้วน",vertical_blind:"ม่านปรับแสง",partition:"ฉากกั้นห้อง",pleated_screen:"มุ้งจีบ"},u=x.length>0;return K.useEffect(()=>{s||c(!1)},[s]),e.jsxs(E,{isOpen:s,onClose:t,title:"จัดการรายการโปรด",children:[e.jsxs("div",{className:"space-y-4 min-h-[300px] pb-safe-area",children:[u&&e.jsxs("div",{className:"flex justify-between items-center mb-2 gap-2",children:[e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide flex-1",children:[e.jsx("button",{onClick:()=>o("all"),className:b("px-3 py-1.5 rounded-full text-xs font-medium border transition-all whitespace-nowrap",l==="all"?"bg-slate-900 text-white border-slate-900":"bg-white border-slate-200 text-slate-600"),children:"ทั้งหมด"}),x.map(h=>e.jsx("button",{onClick:()=>o(h),className:b("px-3 py-1.5 rounded-full text-xs font-medium border transition-all whitespace-nowrap",l===h?"bg-blue-600 text-white border-blue-600":"bg-white border-slate-200 text-slate-600"),children:p[h]||h},h))]}),e.jsx("button",{onClick:()=>c(!m),className:b("flex items-center gap-1.5 text-sm font-bold px-3 py-1.5 rounded-lg transition-colors shrink-0 shadow-sm border",m?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-slate-50"),children:m?"เสร็จสิ้น":e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"w-3.5 h-3.5"})," แก้ไข"]})})]}),!u&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-slate-400",children:[e.jsx(je,{className:"w-12 h-12 mb-2 opacity-20"}),e.jsx("p",{children:"ยังไม่มีรายการโปรด"}),e.jsxs("p",{className:"text-xs mt-1",children:["กดปุ่มดาว ",e.jsx(je,{className:"w-3 h-3 inline"})," ในหน้าเพิ่มสินค้าเพื่อบันทึก"]})]}),u&&e.jsx("div",{className:"space-y-6",children:d.map(h=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2 border-b border-slate-100 pb-1",children:[e.jsx(R,{className:"w-3 h-3"})," ",p[h]||h]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:a[h].map(g=>e.jsx("div",{className:"relative overflow-hidden group",children:e.jsxs("div",{className:b("flex items-center p-3 bg-white rounded-xl border border-slate-100 shadow-sm transition-all duration-300 ease-ios",m&&"border-red-100 bg-red-50/10 pl-12"),children:[e.jsx("div",{className:b("absolute left-3 top-1/2 -translate-y-1/2 transition-all duration-300 ease-ios z-10",m?"opacity-100 scale-100 translate-x-0":"opacity-0 scale-0 -translate-x-4 pointer-events-none"),children:e.jsx("button",{onClick:()=>r(h,g.id),className:"text-white bg-red-500 rounded-full p-1 shadow-md active:scale-90 hover:bg-red-600 transition-colors",children:e.jsx(Is,{className:"w-5 h-5 fill-white text-red-500"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-slate-800 text-sm truncate",children:g.code}),g.price>0&&e.jsx("div",{className:"text-xs text-slate-500 font-mono mt-0.5",children:F(g.price)})]})]})},g.id))})]},h))})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-100 flex justify-end",children:e.jsx(C,{variant:"ghost",onClick:t,children:"ปิดหน้าต่าง"})})]})},aa=({isOpen:s,onClose:t})=>{const a=k(n=>n.discount),r=k(n=>n.setDiscount),l=k(n=>n.shopConfig),o=k(n=>n.updateShopConfig),{grandTotal:m}=ue(),[c,x]=f.useState(a.is_enabled??a.value>0),[d,p]=f.useState(a.type),[u,h]=f.useState(a.value>0?a.value.toString():""),[g,j]=f.useState(l.baseVatRate>0),_=n=>{if(d===n)return;const v=N(u);if(v===0||m===0){p(n);return}let M=0;n==="percent"?M=v/m*100:M=m*v/100;const A=Math.round(M*100)/100;p(n),h(A.toString())},y=f.useMemo(()=>{const n=N(u);let v=0;c&&n>0&&(d==="percent"?v=m*n/100:v=n,v>m&&(v=m));const M=m-v,A=g?M*.07:0,P=M+A;return{discountAmt:v,afterDiscount:M,vatAmt:A,netTotal:P}},[m,c,d,u,g]),i=()=>{const n=N(u);r({type:d,value:n,is_enabled:c}),o({baseVatRate:g?7:0}),t()};return e.jsx(E,{isOpen:s,onClose:t,title:"ส่วนลด & ภาษี (Discount & VAT)",children:e.jsxs("div",{className:"space-y-6 pb-safe-area",children:[e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-2xl border border-slate-100",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-800",children:"เปิดใช้งานส่วนลด"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Enable Discount"})]}),e.jsx(L,{checked:c,onCheckedChange:x})]}),e.jsx("div",{className:b("space-y-4 transition-all duration-300",!c&&"opacity-50 pointer-events-none grayscale"),children:e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(w,{label:"มูลค่าส่วนลด",placeholder:"0.00",value:u,onChange:n=>h(n.target.value),inputMode:"decimal",className:"text-xl font-bold text-slate-900",autoFocus:!0})}),e.jsxs("div",{className:"bg-slate-100 p-1 rounded-xl flex shrink-0 h-12 items-center",children:[e.jsxs("button",{onClick:()=>_("amount"),className:b("h-10 px-4 rounded-lg text-sm font-bold flex items-center gap-2 transition-all",d==="amount"?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-400 hover:text-slate-600"),children:[e.jsx($s,{className:"w-4 h-4"})," บาท"]}),e.jsx("div",{className:"px-1 text-slate-300",children:e.jsx(Ls,{className:"w-3 h-3"})}),e.jsxs("button",{onClick:()=>_("percent"),className:b("h-10 px-4 rounded-lg text-sm font-bold flex items-center gap-2 transition-all",d==="percent"?"bg-white text-slate-900 shadow-sm ring-1 ring-black/5":"text-slate-400 hover:text-slate-600"),children:[e.jsx(Os,{className:"w-4 h-4"})," %"]})]})]})}),e.jsx("hr",{className:"border-slate-100"}),e.jsxs("div",{className:"flex items-center justify-between py-2 px-1",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-900",children:"ภาษีมูลค่าเพิ่ม 7% (VAT)"}),e.jsx("span",{className:"text-xs text-slate-500",children:"คำนวณจากยอดหลังหักส่วนลด"})]}),e.jsx(L,{checked:g,onCheckedChange:j})]}),e.jsxs("div",{className:"bg-slate-900 text-white p-5 rounded-3xl shadow-xl space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs font-bold uppercase tracking-wider mb-2",children:[e.jsx(Ve,{className:"w-4 h-4"})," สรุปยอดรวม (Preview)"]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-slate-300",children:[e.jsx("span",{children:"ยอดรวมสินค้า"}),e.jsx("span",{className:"font-mono",children:F(m)})]}),y.discountAmt>0&&e.jsxs("div",{className:"flex justify-between text-green-400",children:[e.jsxs("span",{children:["ส่วนลด ",d==="percent"?`(${u}%)`:""]}),e.jsxs("span",{className:"font-mono",children:["-",F(y.discountAmt)]})]}),e.jsxs("div",{className:"flex justify-between text-slate-400 text-xs pt-1",children:[e.jsx("span",{children:"ยอดหลังหักส่วนลด"}),e.jsx("span",{className:"font-mono",children:F(y.afterDiscount)})]}),y.vatAmt>0&&e.jsxs("div",{className:"flex justify-between text-blue-300",children:[e.jsx("span",{children:"VAT 7%"}),e.jsxs("span",{className:"font-mono",children:["+",F(y.vatAmt)]})]})]}),e.jsxs("div",{className:"pt-3 mt-2 border-t border-white/10 flex justify-between items-end",children:[e.jsx("span",{className:"text-lg font-bold",children:"ยอดสุทธิ"}),e.jsx("span",{className:"text-2xl font-bold font-mono tracking-tight text-white",children:F(y.netTotal)})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(C,{variant:"ghost",onClick:t,className:"flex-1",children:"ยกเลิก"}),e.jsx(C,{onClick:i,className:"flex-1 bg-slate-900 text-white min-w-[120px]",children:"บันทึก"})]})]})})},la=({isOpen:s,onClose:t,roomId:a})=>{const r=k(i=>i.rooms.find(n=>n.id===a)),l=k(i=>i.updateRoomDefaults),o=r?.room_defaults||{},[m,c]=f.useState(String(o.width_m||"")),[x,d]=f.useState(String(o.height_m||"")),[p,u]=f.useState(String(o.default_fabric_price||"")),[h,g]=f.useState(String(o.default_wallpaper_price||"")),[j,_]=f.useState(String(o.default_blind_price||"")),y=()=>{a&&l(a,{width_m:m,height_m:x,default_fabric_price:p,default_wallpaper_price:h,default_blind_price:j}),t()};return e.jsx(E,{isOpen:s,onClose:t,title:"ตั้งค่าเริ่มต้นห้อง",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{label:"ความกว้าง (ม.)",value:m,onChange:i=>c(i.target.value)}),e.jsx(w,{label:"ความสูง (ม.)",value:x,onChange:i=>d(i.target.value)}),e.jsxs("div",{className:"pt-2 border-t border-slate-100",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-900 mb-2",children:"ราคาเริ่มต้น (Defaults)"}),e.jsx(w,{label:"ผ้า (บาท/ม.)",value:p,onChange:i=>u(i.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-2",children:[e.jsx(w,{label:"วอลล์ (บาท/ม้วน)",value:h,onChange:i=>g(i.target.value)}),e.jsx(w,{label:"มู่ลี่ (บาท/ตร.ล.)",value:j,onChange:i=>_(i.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(C,{variant:"ghost",onClick:t,children:"ยกเลิก"}),e.jsxs(C,{onClick:y,className:"gap-2",children:[e.jsx(Qe,{className:"w-4"})," บันทึก"]})]})]})})},ra=({isOpen:s,onClose:t})=>{const[a,r]=f.useState(null),l=k(c=>c.loadState),o=()=>{try{r(null);const c=k.getState(),x={customer:c.customer,rooms:c.rooms,shopConfig:c.shopConfig,discount:c.discount,favorites:c.favorites,version:"1.0.0",exportDate:new Date().toISOString()},d=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),p=URL.createObjectURL(d),u=document.createElement("a");u.href=p,u.download=`mtr-backup-${Js(new Date,"yyyy-MM-dd-HHmm")}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(p),t()}catch(c){console.error(c),r("เกิดข้อผิดพลาดในการส่งออกไฟล์")}},m=c=>{const x=c.target.files?.[0];if(!x)return;const d=new FileReader;d.onload=p=>{try{const u=p.target?.result,h=JSON.parse(u);if(!h.rooms||!Array.isArray(h.rooms))throw new Error("รูปแบบไฟล์ไม่ถูกต้อง (Missing rooms)");confirm(`ยืนยันการนำเข้าข้อมูลจากไฟล์ ${x.name}? ข้อมูลปัจจุบันจะถูกทับทั้งหมด`)&&(l(h),t(),setTimeout(()=>window.location.reload(),500))}catch(u){console.error(u),r("ไม่สามารถอ่านไฟล์ได้ หรือรูปแบบไฟล์ไม่ถูกต้อง")}},d.readAsText(x),c.target.value=""};return e.jsx(E,{isOpen:s,onClose:t,title:"สำรอง / กู้คืนข้อมูล",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 border border-slate-200 rounded-2xl bg-slate-50",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-base font-semibold text-slate-800 mb-2",children:[e.jsx(Me,{className:"w-5 h-5 text-blue-600"}),"ส่งออกข้อมูล (Backup)"]}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"บันทึกข้อมูลงานปัจจุบันทั้งหมด (ลูกค้า, ห้อง, รายการ, การตั้งค่า) ลงในไฟล์ .json"}),e.jsxs(C,{onClick:o,className:"w-full gap-2 bg-white border border-slate-300 text-slate-700 hover:bg-slate-50",children:[e.jsx(Me,{className:"w-4 h-4"}),"ดาวน์โหลดไฟล์ Backup (.json)"]})]}),e.jsxs("div",{className:"p-4 border border-red-200 bg-red-50 rounded-2xl",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-base font-semibold text-red-700 mb-3",children:[e.jsx(ie,{className:"w-5 h-5"}),"นำเข้าข้อมูล (Import)"]}),e.jsxs("p",{className:"text-sm text-red-600 mb-4",children:[e.jsx("strong",{children:"คำเตือน:"})," การนำเข้าไฟล์ .json จะลบและเขียนทับข้อมูลปัจจุบันทั้งหมด"]}),e.jsxs(C,{variant:"destructive",className:"w-full gap-2",onClick:()=>document.getElementById("file-importer")?.click(),children:[e.jsx(Es,{className:"w-4 h-4"}),"เลือกไฟล์ .json เพื่อนำเข้า..."]}),e.jsx("input",{type:"file",id:"file-importer",className:"hidden",accept:".json,application/json",onChange:m})]}),a&&e.jsx("p",{className:"text-sm text-red-600 text-center bg-red-50 p-2 rounded",children:a})]})})},na=s=>{const{width:t=0,height:a=0}=s,o=t>0&&a>0?Math.min(80/t,80/a):1,m=t*o||50,c=a*o||50,x=(100-m)/2,d=(90-c)/2;return{x,y:d,w:m,h:c}},ia=(s,t)=>{const a=s.style==="ม่านพับ";let r="";if(a){const m=t.h/4;for(let c=0;c<4;c++)r+=`<rect x="${t.x}" y="${t.y+c*m}" width="${t.w}" height="${m-1}" fill="#e2e8f0" stroke="#94a3b8" stroke-width="0.5" />`}else{r=`<rect x="${t.x}" y="${t.y}" width="${t.w}" height="${t.h}" fill="#f1f5f9" stroke="#cbd5e1" rx="2" />`;for(let o=1;o<4;o++)r+=`<path d="M${t.x+t.w/4*o} ${t.y} L${t.x+t.w/4*o} ${t.y+t.h}" stroke="#e2e8f0" stroke-width="1" />`}return`<rect x="${t.x-2}" y="${t.y-2}" width="${t.w+4}" height="2" fill="#64748b" />`+r},oa=(s,t)=>{const a=`<pattern id="p-${s.wallpaper_code}" width="4" height="4" patternUnits="userSpaceOnUse">
      <path d="M0 4L4 0M-1 1L1 -1M3 5L5 3" stroke="#cbd5e1" stroke-width="0.5"/>
  </pattern>`,r=`<rect x="${t.x}" y="${t.y}" width="${t.w}" height="${t.h}" fill="url(#p-${s.wallpaper_code})" stroke="#94a3b8" />`;return`<defs>${a}</defs>${r}`},ca=(s,t)=>{const r=t.h/8;let l="";for(let m=0;m<8;m++)l+=`<line x1="${t.x}" y1="${t.y+m*r}" x2="${t.x+t.w}" y2="${t.y+m*r}" stroke="#cbd5e1" stroke-width="1" />`;return`<rect x="${t.x}" y="${t.y}" width="${t.w}" height="${t.h}" fill="none" stroke="#94a3b8" stroke-width="1" />`+l},da=s=>{if(s.type==="removal"||s.is_suspended)return'<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="20" fill="#f1f5f9"/><path d="M40 60 L60 40 M40 40 L60 60" stroke="#cbd5e1" stroke-width="2"/></svg>';let t=0,a=0;"width_m"in s&&"height_m"in s?(t=N(s.width_m),a=N(s.height_m)):s.type==="wallpaper"&&(t=3,a=2.6);const r=na({width:t,height:a});let l="";return s.type==="curtain"?l=ia(s,r):s.type==="wallpaper"?l=oa(s,r):l=ca(s,r),`<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">${l}</svg>`},xa=K.forwardRef((s,t)=>{const{shopConfig:a,rooms:r}=k(m=>m),l=new Date().toLocaleDateString("th-TH",{dateStyle:"long"}),o=m=>({__html:da(m)});return e.jsxs("div",{ref:t,className:"w-[210mm] min-h-[297mm] bg-white p-[15mm] mx-auto text-slate-900 relative flex flex-col font-sans",children:[e.jsxs("div",{className:"flex justify-between items-end border-b-2 border-slate-800 pb-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:a.name||"Marnthara"}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["วันที่: ",l]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold",children:"LOOKBOOK"}),e.jsx("div",{className:"text-sm text-slate-500",children:"รายการสินค้าพร้อมรูปภาพ"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-6 content-start",children:r.map(m=>m.items.length===0?null:m.items.map((c,x)=>{if(c.is_suspended)return null;let d=U[c.type]?.name||"สินค้า",p="";const u=[];if(c.type==="curtain"){const h=c;d=`${h.style||"ผ้าม่าน"} (${h.fabric_variant})`,h.code&&u.push(`ผ้า: ${h.code}`),h.sheer_code&&u.push(`โปร่ง: ${h.sheer_code}`),h.bracket_color&&u.push(`ราง: ${h.bracket_color}`),p=`${I(h.width_m)} x ${I(h.height_m)} ม.`}else if(c.type==="wallpaper"){const h=c;d="วอลล์เปเปอร์",h.wallpaper_code&&u.push(`รหัส: ${h.wallpaper_code}`),p=`${h.widths.length} ผนัง (สูง ${I(h.height_m)} ม.)`}else if(["wooden_blind","roller_blind","vertical_blind","aluminum_blind","partition","pleated_screen"].includes(c.type)){const h=c;h.code&&u.push(`รหัส: ${h.code}`),p=`${I(h.width_m)} x ${I(h.height_m)} ม.`,c.type==="wooden_blind"?d=`มู่ลี่${h.fabric_variant||""}`:c.type==="roller_blind"?d=`ม่านม้วน (${h.fabric_variant||""})`:c.type==="partition"?d=`ฉากกั้นห้อง (${h.opening_style||""})`:c.type==="pleated_screen"&&(d=`มุ้งจีบ (${h.opening_style||""})`),h.adjustment_side&&u.push(h.adjustment_side)}else c.type==="removal"&&(d=c.description||"งานรื้อถอน");return e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden flex bg-white break-inside-avoid",children:[e.jsx("div",{className:"w-1/2 bg-slate-50 flex items-center justify-center p-2 min-h-[140px]",dangerouslySetInnerHTML:o(c)}),e.jsxs("div",{className:"w-1/2 p-3 flex flex-col relative",children:[e.jsxs("div",{className:"inline-block self-start px-2 py-0.5 bg-slate-100 text-[10px] font-bold text-slate-500 rounded mb-1",children:["🏠 ",m.name]}),e.jsx("div",{className:"font-bold text-sm text-slate-900 leading-tight mb-1",children:d}),e.jsx("div",{className:"text-sm font-mono font-bold text-slate-800 border-b border-dashed border-slate-300 pb-1 mb-2",children:p}),e.jsx("ul",{className:"text-xs text-slate-600 space-y-1",children:u.map((h,g)=>e.jsxs("li",{className:"truncate",children:["• ",h]},g))}),c.notes&&e.jsxs("div",{className:"mt-auto pt-1 text-[10px] text-orange-600 line-clamp-2",children:["⚠ ",c.notes]})]})]},`${m.id}-${c.id}-${x}`)}))}),e.jsx("div",{className:"mt-auto pt-8 text-center text-[10px] text-slate-400",children:"เอกสารสร้างโดยระบบ Marnthara QOL • หน้า 1/1"})]})}),ma=({isOpen:s,onClose:t})=>{const a=k(c=>c.rooms),r=f.useRef(null),[l,o]=f.useState(!1),m=es.useReactToPrint({contentRef:r,documentTitle:`QC_Lookbook_${new Date().toISOString().split("T")[0]}`,onBeforeGetContent:()=>(o(!0),Promise.resolve()),onAfterPrint:()=>o(!1)});return e.jsxs(E,{isOpen:s,onClose:t,title:"Lookbook / รายการสินค้า (Preview)",maxWidth:"2xl",children:[e.jsx("div",{className:"space-y-6 pb-safe-area",children:a.map(c=>e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 border border-slate-100",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-3 flex items-center gap-2",children:["🏠 ",c.name]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:c.items.filter(x=>!x.is_suspended).map(x=>e.jsxs("div",{className:"bg-white p-3 rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[e.jsx("div",{className:"aspect-[4/3] bg-slate-50 rounded-lg mb-2 flex items-center justify-center overflow-hidden relative",children:e.jsx("div",{className:"text-xs text-slate-400",children:"Preview"})}),e.jsxs("div",{className:"mt-auto",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-semibold text-sm text-slate-700",children:U[x.type]?.name}),"width_m"in x&&e.jsxs("div",{className:"bg-slate-900 text-white text-xs font-mono px-1.5 py-0.5 rounded",children:[I(x.width_m)," × ",I(x.height_m)]})]}),e.jsxs("div",{className:"text-xs text-slate-600 space-y-1 mt-auto",children:["fabric_variant"in x&&e.jsxs("div",{children:["• วัสดุ/ผ้า: ",x.fabric_variant]}),"code"in x&&x.code&&e.jsxs("div",{children:["• รหัส: ",e.jsx("span",{className:"font-mono font-bold",children:x.code})]}),"adjustment_side"in x&&e.jsxs("div",{children:["• ปรับ: ",x.adjustment_side]}),x.notes&&e.jsxs("div",{className:"text-amber-600 mt-1",children:["⚠ ",x.notes]})]})]})]},x.id))})]},c.id))}),e.jsxs("div",{className:"flex justify-end pt-4 border-t border-slate-100",children:[e.jsx(C,{onClick:t,children:"ปิดหน้าต่าง"}),e.jsx(C,{onClick:()=>m(),disabled:l,className:"ml-2 bg-slate-900 text-white",children:l?"กำลังเตรียม...":"พิมพ์ Lookbook"})]}),e.jsx("div",{style:{display:"none"},children:e.jsx("div",{ref:r,children:e.jsx(xa,{})})})]})},ha=({isOpen:s,onClose:t})=>{const a=k(c=>c.rooms),{finalTotal:r}=ue(),l=a.map(c=>({...c,items:c.items.filter(x=>!x.is_suspended),total:c.items.filter(x=>!x.is_suspended).reduce((x,d)=>x+T.getItemPrice(d),0)})).filter(c=>c.items.length>0),o=l.reduce((c,x)=>c+x.items.length,0),m=c=>c.type==="curtain"&&"width_m"in c?`${I(c.width_m)}×${I(c.height_m)} | ${c.style}`:"width_m"in c&&"height_m"in c?`${I(c.width_m)}×${I(c.height_m)}`:"";return e.jsxs(E,{isOpen:s,onClose:t,title:"สรุปภาพรวม (Project Overview)",maxWidth:"md",children:[e.jsxs("div",{className:"bg-slate-900 text-white rounded-2xl p-6 mb-6 shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-white/10 rounded-full blur-2xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-slate-300 text-sm font-medium mb-1",children:"มูลค่าโครงการรวม"}),e.jsx("span",{className:"text-4xl font-bold font-mono tracking-tight",children:F(r)}),e.jsxs("div",{className:"flex gap-4 mt-4 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"w-3 h-3"})," ",l.length," ห้อง"]}),e.jsx("div",{className:"w-px h-3 bg-slate-700"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Be,{className:"w-3 h-3"})," ",o," รายการ"]})]})]})]}),e.jsxs("div",{className:"space-y-4 pb-safe-area",children:[l.map(c=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 px-4 py-2.5 border-b border-slate-100 flex justify-between items-center",children:[e.jsxs("div",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400"}),c.name]}),e.jsx("span",{className:"font-mono text-xs font-bold text-slate-600",children:F(c.total)})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:c.items.map((x,d)=>e.jsxs("div",{className:"px-4 py-2 flex justify-between items-baseline hover:bg-slate-50/50",children:[e.jsx("div",{className:"flex-1 min-w-0 pr-4",children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-[10px] font-bold text-slate-400 min-w-[20px]",children:["#",d+1]}),e.jsx("span",{className:"text-sm font-medium text-slate-700 truncate",children:U[x.type]?.name}),e.jsxs("span",{className:"text-xs text-slate-400 truncate font-mono",children:["(",m(x),")"]})]})}),e.jsx("div",{className:"text-sm text-slate-600 font-mono shrink-0",children:F(T.getItemPrice(x))})]},x.id))})]},c.id)),l.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"ยังไม่มีรายการสินค้า"})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-100",children:e.jsx(C,{onClick:t,className:"w-full sm:w-auto min-w-[120px]",children:"ปิดหน้าต่าง"})})]})},pa=({icon:s,label:t,onClick:a})=>e.jsxs("button",{onClick:a,className:b("w-full flex items-center gap-4 p-4 rounded-2xl border transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]","bg-white/60 border-slate-200 hover:bg-white/80 hover:border-slate-300","dark:bg-[#1E1030]/60 dark:border-violet-500/40 dark:hover:bg-[#1E1030]/80 dark:hover:border-violet-500/60"),children:[e.jsx("div",{className:b("w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-300","bg-slate-50/80 border border-slate-200 text-slate-600","dark:bg-white/5 dark:border-violet-400/30 dark:text-violet-300"),children:s}),e.jsx("span",{className:b("font-semibold text-slate-700 text-left","dark:text-violet-100"),children:t})]}),ua=({isOpen:s,onClose:t,onOpenPdf:a,onOpenLookbook:r,onOpenCustomer:l,onOpenShopSettings:o,onOpenDiscount:m,onOpenData:c,onOpenFavorites:x})=>{const{theme:d,toggleTheme:p}=as(),[u,h]=f.useState(null),g=O(y=>y.addToast),j=(y,i)=>{navigator.clipboard.writeText(y),h(i),g("success","สำเร็จ","คัดลอกลง Clipboard แล้ว"),setTimeout(()=>h(null),2e3)},_=[{title:"เอกสาร",items:[{icon:e.jsx(me,{className:"w-6 h-6"}),label:"PDF",onClick:a},{icon:e.jsx(Vs,{className:"w-6 h-6"}),label:"Lookbook",onClick:r}]},{title:"ลูกค้า",items:[{icon:e.jsx(Hs,{className:"w-6 h-6"}),label:"จัดการลูกค้า",onClick:l}]},{title:"ร้านค้า",items:[{icon:e.jsx($e,{className:"w-6 h-6"}),label:"ตั้งค่าร้านค้า",onClick:o},{icon:e.jsx(R,{className:"w-6 h-6"}),label:"ส่วนลด",onClick:m}]},{title:"ข้อมูล",items:[{icon:e.jsx(Ws,{className:"w-6 h-6"}),label:"ข้อมูลการขาย",onClick:c},{icon:e.jsx(ae,{className:"w-6 h-6"}),label:"รายการโปรด",onClick:x}]}];return e.jsx(E,{isOpen:s,onClose:t,title:"เมนูหลัก (Main Menu)",maxWidth:"sm",children:e.jsxs("div",{className:"space-y-6 pb-4 relative z-10",children:[e.jsx("div",{className:"relative group perspective-1000",children:e.jsxs("button",{onClick:p,className:b("relative w-full flex items-center justify-between p-4 rounded-2xl border transition-all duration-500 overflow-hidden group",d==="dark"?"bg-[#1E1030]/60 border-violet-500/40 shadow-[0_0_30px_rgba(139,92,246,0.2)]":"bg-white/60 border-slate-200 shadow-sm"),children:[e.jsx("div",{className:b("absolute inset-0 bg-gradient-to-r from-violet-600/20 via-fuchsia-600/10 to-amber-500/10 opacity-0 transition-opacity duration-700",d==="dark"?"opacity-100 animate-pulse":"")}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:b("w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-500 backdrop-blur-md border shadow-inner",d==="dark"?"bg-white/5 border-amber-500/30 text-amber-400 shadow-[inset_0_0_15px_rgba(251,191,36,0.2)]":"bg-amber-50/80 border-amber-200 text-amber-500"),children:d==="dark"?e.jsx(Rs,{className:"w-6 h-6 animate-[spin_4s_linear_infinite]"}):e.jsx(Ds,{className:"w-6 h-6"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:b("font-bold text-[16px] tracking-tight flex items-center gap-2",d==="dark"?"text-white drop-shadow-[0_0_8px_rgba(167,139,250,0.8)]":"text-slate-900"),children:d==="dark"?"Midnight Violet":"Daylight Glass"}),e.jsx("div",{className:b("text-xs font-medium",d==="dark"?"text-violet-300":"text-slate-500"),children:d==="dark"?"Expensive Dark Mode":"Clean Light Interface"})]})]}),e.jsx("div",{className:b("w-14 h-8 rounded-full relative transition-all duration-500 border backdrop-blur-sm",d==="dark"?"bg-[#0D0814]/80 border-violet-400 shadow-[0_0_15px_rgba(139,92,246,0.5)]":"bg-slate-200/80 border-slate-300"),children:e.jsx("div",{className:b("absolute top-0.5 w-6 h-6 rounded-full shadow-md transition-all duration-500 cubic-bezier(0.34, 1.56, 0.64, 1) flex items-center justify-center",d==="dark"?"translate-x-[28px] bg-gradient-to-br from-violet-400 to-fuchsia-600 border border-white/20":"translate-x-[2px] bg-white border border-slate-100"),children:d==="dark"&&e.jsx(qs,{className:"w-3 h-3 text-white fill-white"})})})]})}),e.jsx("div",{className:"space-y-6",children:_.map(y=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:b("text-sm font-semibold px-2","text-slate-600","dark:text-violet-300"),children:y.title}),e.jsx("div",{className:"space-y-2",children:y.items.map(i=>e.jsx(pa,{icon:i.icon,label:i.label,onClick:i.onClick},i.label))})]},y.title))}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-200 dark:border-white/10",children:[e.jsx("h3",{className:b("text-sm font-semibold px-2","text-slate-600","dark:text-violet-300"),children:"เครื่องมือช่วยขาย"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("button",{onClick:()=>j("สรุปยอด...",1),className:b("w-full flex items-center gap-4 p-4 rounded-2xl border transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]","bg-green-50/50 border-green-200 hover:bg-green-100/50","dark:bg-green-900/20 dark:border-green-500/30 dark:hover:bg-green-900/30"),children:[e.jsx("div",{className:b("w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-300","bg-green-100 text-green-600","dark:bg-green-500/20 dark:text-green-400"),children:u===1?e.jsx(se,{className:"w-6 h-6"}):e.jsx(zs,{className:"w-6 h-6"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:b("font-semibold","text-slate-700 dark:text-green-100"),children:"สรุปยอดส่งไลน์"}),e.jsx("div",{className:b("text-xs","text-slate-500 dark:text-green-300/70"),children:"คัดลอกข้อความสรุปยอดขาย"})]})]}),e.jsxs("button",{onClick:()=>j("ใบงานช่าง...",2),className:b("w-full flex items-center gap-4 p-4 rounded-2xl border transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]","bg-orange-50/50 border-orange-200 hover:bg-orange-100/50","dark:bg-orange-900/20 dark:border-orange-500/30 dark:hover:bg-orange-900/30"),children:[e.jsx("div",{className:b("w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-300","bg-orange-100 text-orange-600","dark:bg-orange-500/20 dark:text-orange-400"),children:u===2?e.jsx(se,{className:"w-6 h-6"}):e.jsx(ye,{className:"w-6 h-6"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:b("font-semibold","text-slate-700 dark:text-orange-100"),children:"ใบงานช่างเย็บ"}),e.jsx("div",{className:b("text-xs","text-slate-500 dark:text-orange-300/70"),children:"คัดลอกสเปคผ้าและขนาด"})]})]})]})]}),e.jsxs("div",{className:"pt-4 mt-2",children:[e.jsxs(C,{variant:"outline",className:"w-full justify-between text-slate-500 font-normal hover:bg-slate-50 border-dashed dark:border-white/10 dark:hover:bg-white/5 dark:text-slate-400",onClick:()=>{t(),c()},children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"w-4 h-4"})," สำรอง / กู้คืนข้อมูล (Backup)"]}),e.jsx(Us,{className:"w-4 h-4"})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("span",{className:"text-[10px] text-slate-300 dark:text-slate-600",children:"v6.1.0 (Stable)"})})]})]})})},ba=()=>{const{activeModal:s,modalProps:t,closeModal:a,addItem:r,updateItem:l,openModal:o}=k(),m=O(_=>_.addToast),c=_=>{const{roomId:y,mode:i,itemId:n}=t;if(!y){console.error("Missing roomId in modalProps");return}i==="add"?(r(y,_),m("success","เพิ่มรายการเรียบร้อย")):i==="edit"&&n&&(l(y,n,_),m("success","บันทึกการแก้ไขเรียบร้อย")),a()},x=()=>{a(),o("pdf")},d=()=>{a(),o("lookbook")},p=()=>{a(),o("customer")},u=()=>{a(),o("shopSettings")},h=()=>{a(),o("discount")},g=()=>{a(),o("data")},j=()=>{a(),o("favoriteManager")};return e.jsxs(e.Fragment,{children:[e.jsx(Kt,{isOpen:s==="item",onClose:a,mode:t.mode||"add",itemType:t.itemType||"set",initialData:t.initialData,onSubmit:c}),e.jsx(Qt,{isOpen:s==="customer",onClose:a}),e.jsx(ea,{isOpen:s==="pdf",onClose:a}),e.jsx(sa,{isOpen:s==="shopSettings",onClose:a},s==="shopSettings"?"shop-open":"shop-closed"),e.jsx(ta,{isOpen:s==="favoriteManager",onClose:a}),e.jsx(aa,{isOpen:s==="discount",onClose:a},s==="discount"?"discount-open":"discount-closed"),e.jsx(ra,{isOpen:s==="data",onClose:a}),e.jsx(ma,{isOpen:s==="lookbook",onClose:a}),e.jsx(ha,{isOpen:s==="projectOverview",onClose:a}),e.jsx(la,{isOpen:s==="roomDefaults",onClose:a,roomId:t.roomId},t.roomId||"defaults"),e.jsx(ua,{isOpen:s==="mainMenu",onClose:a,onOpenPdf:x,onOpenLookbook:d,onOpenCustomer:p,onOpenShopSettings:u,onOpenDiscount:h,onOpenData:g,onOpenFavorites:j})]})};function ga(){const s=k(d=>d.rooms),t=k(d=>d.openModal),a=as(d=>d.theme);f.useEffect(()=>{document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(a)},[a]);const r=()=>t("mainMenu"),l=()=>t("discount"),o=()=>t("projectOverview"),m=d=>{t("item",{mode:"add",roomId:d,itemType:"curtain"})},c=(d,p)=>{t("item",{mode:"edit",roomId:d,itemId:p.id,itemType:p.type,initialData:p})},x=d=>{t("roomDefaults",{roomId:d})};return e.jsxs(e.Fragment,{children:[e.jsx(dt,{onOpenMainMenu:r,onOpenDiscount:l,onOpenOverview:o,children:s.map((d,p)=>e.jsx(mt,{room:d,index:p,totalRooms:s.length,onAddItem:m,onEditItem:c,onOpenDefaults:x},d.id))}),e.jsx(ba,{})," ",e.jsx(pt,{}),e.jsx(ut,{})]})}const rs=()=>{document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)};window.addEventListener("resize",rs);rs();is.createRoot(document.getElementById("root")).render(e.jsx(f.StrictMode,{children:e.jsx(ga,{})}));
